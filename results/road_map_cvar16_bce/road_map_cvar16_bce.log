2020-04-30 14:55:49,406 [MainThread  ] Experiment road_map_cvar16_bce
2020-04-30 14:55:49,407 [MainThread  ] Receive config Namespace(batch_size=16, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', detect_objects=False, device='cuda:0', dup_pos=0, exp_dir='./results/road_map_cvar16_bce', exp_name='road_map_cvar16_bce', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='var_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=100000, finetune_val_interval=2000, finetune_weight_decay=1e-05, gen_road_map=True, image_folder='/scratch/kk4161/DL_project/data', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=16, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=250, results_dir='./results/', road_map_loss='bce', sampling_type='image', synthesizer_nlayers=2, transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-04-30 14:55:49,407 [MainThread  ] Start creating tasks
2020-04-30 14:55:49,407 [MainThread  ] Start loading data
2020-04-30 14:55:49,407 [MainThread  ] Loading custom_sup data
2020-04-30 14:55:49,889 [MainThread  ] Start creating models
2020-04-30 14:55:50,148 [MainThread  ] Loaded supervised model
2020-04-30 14:56:00,925 [MainThread  ] Setup trainer for custom_sup
2020-04-30 14:56:00,926 [MainThread  ] Start training custom_sup
2020-04-30 14:57:46,122 [MainThread  ] train batch 93 / 157 (iter 250), current average result {'ts_road_map': tensor(0.4220, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.5143, grad_fn=<DivBackward0>), 'KLD_loss': tensor(540.1960, grad_fn=<DivBackward0>), 'loss': tensor(540.7103, grad_fn=<DivBackward0>)}
2020-04-30 14:59:27,747 [MainThread  ] train batch 29 / 157 (iter 500), current average result {'ts_road_map': tensor(0.5261, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.4103, grad_fn=<DivBackward0>), 'KLD_loss': tensor(810.2880, grad_fn=<DivBackward0>), 'loss': tensor(810.6983, grad_fn=<DivBackward0>)}
2020-04-30 15:01:03,155 [MainThread  ] train batch 122 / 157 (iter 750), current average result {'ts_road_map': tensor(0.5822, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.3553, grad_fn=<DivBackward0>), 'KLD_loss': tensor(920.4293, grad_fn=<DivBackward0>), 'loss': tensor(920.7849, grad_fn=<DivBackward0>)}
2020-04-30 15:02:43,674 [MainThread  ] train batch 58 / 157 (iter 1000), current average result {'ts_road_map': tensor(0.6216, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.3169, grad_fn=<DivBackward0>), 'KLD_loss': tensor(986.4620, grad_fn=<DivBackward0>), 'loss': tensor(986.7791, grad_fn=<DivBackward0>)}
2020-04-30 15:04:15,305 [MainThread  ] train batch 151 / 157 (iter 1250), current average result {'ts_road_map': tensor(0.6516, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.2886, grad_fn=<DivBackward0>), 'KLD_loss': tensor(1032.7968, grad_fn=<DivBackward0>), 'loss': tensor(1033.0826, grad_fn=<DivBackward0>)}
2020-04-30 15:34:57,430 [MainThread  ] Experiment road_map_cvar16_bce
2020-04-30 15:34:57,436 [MainThread  ] Receive config Namespace(batch_size=8, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', detect_objects=False, device='cuda:0', dup_pos=0, exp_dir='./results/road_map_cvar16_bce', exp_name='road_map_cvar16_bce', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='var_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=200000, finetune_val_interval=2000, finetune_weight_decay=1e-05, gen_road_map=True, image_folder='/scratch/kk4161/DL_project/data', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=16, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=250, results_dir='./results/', road_map_loss='bce', sampling_type='image', synthesizer_nlayers=2, transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-04-30 15:34:57,436 [MainThread  ] Start creating tasks
2020-04-30 15:34:57,437 [MainThread  ] Start loading data
2020-04-30 15:34:57,437 [MainThread  ] Loading custom_sup data
2020-04-30 15:34:57,857 [MainThread  ] Start creating models
2020-04-30 15:34:58,089 [MainThread  ] Loaded supervised model
2020-04-30 15:35:22,863 [MainThread  ] Setup trainer for custom_sup
2020-04-30 15:35:22,864 [MainThread  ] Start training custom_sup
2020-04-30 15:36:13,758 [MainThread  ] train batch 250 / 315 (iter 250), current average result {'loss': tensor(236.7809, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.5290, grad_fn=<DivBackward0>), 'KLD_loss': tensor(236.2520, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.3908, grad_fn=<DivBackward0>)}
2020-04-30 15:37:00,613 [MainThread  ] train batch 185 / 315 (iter 500), current average result {'loss': tensor(332.8502, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.4481, grad_fn=<DivBackward0>), 'KLD_loss': tensor(332.4020, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.4783, grad_fn=<DivBackward0>)}
2020-04-30 15:37:46,132 [MainThread  ] train batch 120 / 315 (iter 750), current average result {'loss': tensor(393.1994, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.3965, grad_fn=<DivBackward0>), 'KLD_loss': tensor(392.8027, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.5334, grad_fn=<DivBackward0>)}
2020-04-30 15:38:30,502 [MainThread  ] train batch 55 / 315 (iter 1000), current average result {'loss': tensor(431.8176, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.3601, grad_fn=<DivBackward0>), 'KLD_loss': tensor(431.4570, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.5720, grad_fn=<DivBackward0>)}
2020-04-30 15:39:10,339 [MainThread  ] train batch 305 / 315 (iter 1250), current average result {'loss': tensor(459.5704, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.3333, grad_fn=<DivBackward0>), 'KLD_loss': tensor(459.2368, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.6010, grad_fn=<DivBackward0>)}
2020-04-30 15:39:55,375 [MainThread  ] train batch 240 / 315 (iter 1500), current average result {'loss': tensor(480.5559, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.3113, grad_fn=<DivBackward0>), 'KLD_loss': tensor(480.2447, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.6246, grad_fn=<DivBackward0>)}
2020-04-30 15:40:39,903 [MainThread  ] train batch 175 / 315 (iter 1750), current average result {'loss': tensor(496.5898, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.2926, grad_fn=<DivBackward0>), 'KLD_loss': tensor(496.2971, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.6448, grad_fn=<DivBackward0>)}
2020-04-30 15:41:24,542 [MainThread  ] train batch 110 / 315 (iter 2000), current average result {'loss': tensor(510.4923, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.2766, grad_fn=<DivBackward0>), 'KLD_loss': tensor(510.2160, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.6624, grad_fn=<DivBackward0>)}
2020-04-30 15:41:24,543 [MainThread  ] Evaluate on  custom_sup:val data
2020-04-30 15:41:37,619 [MainThread  ] Evalutation complete
Average result {'loss': tensor(646.2010), 'recon_loss': tensor(0.4868), 'KLD_loss': tensor(645.7143), 'ts_road_map': tensor(0.6979)}
2020-04-30 15:41:37,620 [MainThread  ] Best validation updated: {'current_iter': 2000, 'best_iter': 2000, 'best_performance': tensor(646.2010)}
2020-04-30 15:41:37,891 [MainThread  ] Save parameters for ./results/road_map_cvar16_bce/finetune_custom_sup_best.ckpt
2020-04-30 15:42:22,628 [MainThread  ] train batch 45 / 315 (iter 2250), current average result {'loss': tensor(617.2894, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.1535, grad_fn=<DivBackward0>), 'KLD_loss': tensor(617.1360, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.8000, grad_fn=<DivBackward0>)}
2020-04-30 15:43:02,840 [MainThread  ] train batch 295 / 315 (iter 2500), current average result {'loss': tensor(622.2172, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.1454, grad_fn=<DivBackward0>), 'KLD_loss': tensor(622.0720, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.8087, grad_fn=<DivBackward0>)}
2020-04-30 16:22:52,006 [MainThread  ] Experiment road_map_cvar16_bce
2020-04-30 16:22:52,016 [MainThread  ] Receive config Namespace(batch_size=8, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', detect_objects=False, device='cuda:0', dup_pos=0, exp_dir='./results/road_map_cvar16_bce', exp_name='road_map_cvar16_bce', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='var_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=200000, finetune_val_interval=2000, finetune_weight_decay=1e-05, gen_road_map=True, image_folder='/scratch/kk4161/DL_project/data', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=16, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=250, results_dir='./results/', road_map_loss='bce', sampling_type='image', synthesizer_nlayers=2, transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-04-30 16:22:52,017 [MainThread  ] Start creating tasks
2020-04-30 16:22:52,017 [MainThread  ] Start loading data
2020-04-30 16:22:52,017 [MainThread  ] Loading custom_sup data
2020-04-30 16:22:52,491 [MainThread  ] Start creating models
2020-04-30 16:22:52,723 [MainThread  ] Loaded supervised model
2020-04-30 16:22:55,878 [MainThread  ] Setup trainer for custom_sup
2020-04-30 16:22:55,879 [MainThread  ] Start training custom_sup
2020-04-30 16:23:41,461 [MainThread  ] train batch 250 / 315 (iter 250), current average result {'KLD_loss': tensor(6.5121, grad_fn=<DivBackward0>), 'loss': tensor(7.2181, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7060, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2894, grad_fn=<DivBackward0>)}
2020-04-30 16:24:25,764 [MainThread  ] train batch 185 / 315 (iter 500), current average result {'KLD_loss': tensor(3.4356, grad_fn=<DivBackward0>), 'loss': tensor(4.1345, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.6989, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2778, grad_fn=<DivBackward0>)}
2020-04-30 16:25:10,158 [MainThread  ] train batch 120 / 315 (iter 750), current average result {'KLD_loss': tensor(2.3247, grad_fn=<DivBackward0>), 'loss': tensor(3.0202, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.6956, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2737, grad_fn=<DivBackward0>)}
2020-04-30 16:25:54,585 [MainThread  ] train batch 55 / 315 (iter 1000), current average result {'KLD_loss': tensor(1.7583, grad_fn=<DivBackward0>), 'loss': tensor(2.4518, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.6935, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2719, grad_fn=<DivBackward0>)}
2020-04-30 16:26:34,325 [MainThread  ] train batch 305 / 315 (iter 1250), current average result {'KLD_loss': tensor(1.4151, grad_fn=<DivBackward0>), 'loss': tensor(2.1070, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.6919, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2706, grad_fn=<DivBackward0>)}
2020-04-30 16:27:19,209 [MainThread  ] train batch 240 / 315 (iter 1500), current average result {'KLD_loss': tensor(1.1848, grad_fn=<DivBackward0>), 'loss': tensor(1.8754, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.6906, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2698, grad_fn=<DivBackward0>)}
2020-04-30 16:28:03,826 [MainThread  ] train batch 175 / 315 (iter 1750), current average result {'KLD_loss': tensor(1.0193, grad_fn=<DivBackward0>), 'loss': tensor(1.7088, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.6896, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2691, grad_fn=<DivBackward0>)}
2020-04-30 16:28:48,470 [MainThread  ] train batch 110 / 315 (iter 2000), current average result {'KLD_loss': tensor(0.8949, grad_fn=<DivBackward0>), 'loss': tensor(1.5835, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.6886, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2683, grad_fn=<DivBackward0>)}
2020-04-30 16:28:48,470 [MainThread  ] Evaluate on  custom_sup:val data
2020-04-30 16:29:03,690 [MainThread  ] Evalutation complete
Average result {'KLD_loss': tensor(0.1171), 'loss': tensor(0.8103), 'recon_loss': tensor(0.6932), 'ts_road_map': tensor(0.3008)}
2020-04-30 16:29:03,691 [MainThread  ] Best validation updated: {'current_iter': 2000, 'best_iter': 2000, 'best_performance': tensor(0.8103)}
2020-04-30 16:29:03,801 [MainThread  ] Save parameters for ./results/road_map_cvar16_bce/finetune_custom_sup_best.ckpt
2020-04-30 16:29:49,398 [MainThread  ] train batch 45 / 315 (iter 2250), current average result {'KLD_loss': tensor(0.0216, grad_fn=<DivBackward0>), 'loss': tensor(0.7044, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.6828, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2662, grad_fn=<DivBackward0>)}
2020-04-30 16:30:31,208 [MainThread  ] train batch 295 / 315 (iter 2500), current average result {'KLD_loss': tensor(0.0190, grad_fn=<DivBackward0>), 'loss': tensor(0.7010, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.6821, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2653, grad_fn=<DivBackward0>)}
2020-04-30 16:31:16,236 [MainThread  ] train batch 230 / 315 (iter 2750), current average result {'KLD_loss': tensor(0.0174, grad_fn=<DivBackward0>), 'loss': tensor(0.6992, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.6818, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2654, grad_fn=<DivBackward0>)}
2020-04-30 16:32:01,148 [MainThread  ] train batch 165 / 315 (iter 3000), current average result {'KLD_loss': tensor(0.0162, grad_fn=<DivBackward0>), 'loss': tensor(0.6978, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.6816, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2653, grad_fn=<DivBackward0>)}
2020-04-30 16:32:45,863 [MainThread  ] train batch 100 / 315 (iter 3250), current average result {'KLD_loss': tensor(0.0153, grad_fn=<DivBackward0>), 'loss': tensor(0.6967, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.6814, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2652, grad_fn=<DivBackward0>)}
2020-04-30 16:33:30,356 [MainThread  ] train batch 35 / 315 (iter 3500), current average result {'KLD_loss': tensor(0.0144, grad_fn=<DivBackward0>), 'loss': tensor(0.6955, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.6811, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2647, grad_fn=<DivBackward0>)}
2020-04-30 16:34:10,632 [MainThread  ] train batch 285 / 315 (iter 3750), current average result {'KLD_loss': tensor(0.0137, grad_fn=<DivBackward0>), 'loss': tensor(0.6947, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.6810, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2648, grad_fn=<DivBackward0>)}
2020-04-30 16:34:55,313 [MainThread  ] train batch 220 / 315 (iter 4000), current average result {'KLD_loss': tensor(0.0131, grad_fn=<DivBackward0>), 'loss': tensor(0.6940, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.6808, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2648, grad_fn=<DivBackward0>)}
2020-04-30 16:34:55,314 [MainThread  ] Evaluate on  custom_sup:val data
2020-04-30 16:35:07,786 [MainThread  ] Evalutation complete
Average result {'KLD_loss': tensor(0.0658), 'loss': tensor(0.7596), 'recon_loss': tensor(0.6938), 'ts_road_map': tensor(0.2971)}
2020-04-30 16:35:07,787 [MainThread  ] Best validation updated: {'current_iter': 4000, 'best_iter': 4000, 'best_performance': tensor(0.7596)}
2020-04-30 16:35:07,881 [MainThread  ] Save parameters for ./results/road_map_cvar16_bce/finetune_custom_sup_best.ckpt
2020-04-30 16:35:52,653 [MainThread  ] train batch 155 / 315 (iter 4250), current average result {'KLD_loss': tensor(0.0076, grad_fn=<DivBackward0>), 'loss': tensor(0.6871, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.6795, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2635, grad_fn=<DivBackward0>)}
