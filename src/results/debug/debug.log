2020-04-30 22:04:22,951 [MainThread  ] Experiment debug
2020-04-30 22:04:22,952 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', detect_objects=False, device='cuda:0', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2000, finetune_weight_decay=1e-05, gen_road_map=False, image_folder='/scratch/kk4161/DL_project/data', image_pretrain_obj='pirl_nce_loss', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=40000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=250, results_dir='./results/', road_map_loss='bce', sampling_type='image', synthesizer_nlayers=2, transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-04-30 22:04:22,952 [MainThread  ] Start creating tasks
2020-04-30 22:04:22,952 [MainThread  ] Start loading data
2020-04-30 22:04:22,952 [MainThread  ] Loading custom_un_image data
2020-04-30 22:04:22,952 [MainThread  ] Loading custom_sup data
2020-04-30 22:04:45,254 [MainThread  ] Experiment debug
2020-04-30 22:04:45,254 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', detect_objects=False, device='cuda:0', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2000, finetune_weight_decay=1e-05, gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='pirl_nce_loss', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=40000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=250, results_dir='./results/', road_map_loss='bce', sampling_type='image', synthesizer_nlayers=2, transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-04-30 22:04:45,254 [MainThread  ] Start creating tasks
2020-04-30 22:04:45,254 [MainThread  ] Start loading data
2020-04-30 22:04:45,254 [MainThread  ] Loading custom_un_image data
2020-04-30 22:04:45,255 [MainThread  ] Loading custom_sup data
2020-04-30 22:04:45,615 [MainThread  ] Start creating models
2020-04-30 22:04:45,847 [MainThread  ] Loaded image ssl model
2020-04-30 22:04:45,980 [MainThread  ] Loaded supervised model
2020-04-30 22:04:54,589 [MainThread  ] Experiment debug
2020-04-30 22:04:54,590 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2000, finetune_weight_decay=1e-05, gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='pirl_nce_loss', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=40000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', synthesizer_nlayers=2, transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-04-30 22:04:54,590 [MainThread  ] Start creating tasks
2020-04-30 22:04:54,590 [MainThread  ] Start loading data
2020-04-30 22:04:54,590 [MainThread  ] Loading custom_un_image data
2020-04-30 22:04:54,590 [MainThread  ] Loading custom_sup data
2020-04-30 22:04:54,958 [MainThread  ] Start creating models
2020-04-30 22:04:55,190 [MainThread  ] Loaded image ssl model
2020-04-30 22:04:55,313 [MainThread  ] Loaded supervised model
2020-04-30 22:04:55,315 [MainThread  ] Setup trainer for custom_un_image
2020-04-30 22:04:55,315 [MainThread  ] Start training custom_un_image
2020-04-30 22:04:57,754 [MainThread  ] train batch 1 / 32508 (iter 1), current average result {'loss': tensor(11.3236, grad_fn=<DivBackward0>), 'acc': tensor(0.)}
2020-04-30 22:04:59,696 [MainThread  ] train batch 2 / 32508 (iter 2), current average result {'loss': tensor(11.5780, grad_fn=<DivBackward0>), 'acc': tensor(0.)}
2020-04-30 22:05:01,576 [MainThread  ] train batch 3 / 32508 (iter 3), current average result {'loss': tensor(12.0698, grad_fn=<DivBackward0>), 'acc': tensor(0.)}
2020-04-30 22:05:03,507 [MainThread  ] train batch 4 / 32508 (iter 4), current average result {'loss': tensor(12.3484, grad_fn=<DivBackward0>), 'acc': tensor(0.)}
2020-04-30 22:05:12,330 [MainThread  ] Experiment debug
2020-04-30 22:05:12,331 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=1, finetune_weight_decay=1e-05, gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='pirl_nce_loss', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=40000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', synthesizer_nlayers=2, transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-04-30 22:05:12,331 [MainThread  ] Start creating tasks
2020-04-30 22:05:12,331 [MainThread  ] Start loading data
2020-04-30 22:05:12,331 [MainThread  ] Loading custom_un_image data
2020-04-30 22:05:12,332 [MainThread  ] Loading custom_sup data
2020-04-30 22:05:12,695 [MainThread  ] Start creating models
2020-04-30 22:05:12,937 [MainThread  ] Loaded image ssl model
2020-04-30 22:05:13,064 [MainThread  ] Loaded supervised model
2020-04-30 22:05:13,066 [MainThread  ] Setup trainer for custom_un_image
2020-04-30 22:05:13,066 [MainThread  ] Start training custom_un_image
2020-04-30 22:05:15,429 [MainThread  ] train batch 1 / 32508 (iter 1), current average result {'loss': tensor(12.1988, grad_fn=<DivBackward0>), 'acc': tensor(0.)}
2020-04-30 22:05:17,306 [MainThread  ] train batch 2 / 32508 (iter 2), current average result {'loss': tensor(12.6103, grad_fn=<DivBackward0>), 'acc': tensor(0.)}
2020-04-30 22:05:19,187 [MainThread  ] train batch 3 / 32508 (iter 3), current average result {'loss': tensor(12.6659, grad_fn=<DivBackward0>), 'acc': tensor(0.)}
2020-04-30 22:05:21,039 [MainThread  ] train batch 4 / 32508 (iter 4), current average result {'loss': tensor(12.3901, grad_fn=<DivBackward0>), 'acc': tensor(0.)}
2020-04-30 22:05:28,820 [MainThread  ] Experiment debug
2020-04-30 22:05:28,820 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2000, finetune_weight_decay=1e-05, gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='pirl_nce_loss', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=40000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=1, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', synthesizer_nlayers=2, transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-04-30 22:05:28,820 [MainThread  ] Start creating tasks
2020-04-30 22:05:28,820 [MainThread  ] Start loading data
2020-04-30 22:05:28,820 [MainThread  ] Loading custom_un_image data
2020-04-30 22:05:28,821 [MainThread  ] Loading custom_sup data
2020-04-30 22:05:29,191 [MainThread  ] Start creating models
2020-04-30 22:05:29,423 [MainThread  ] Loaded image ssl model
2020-04-30 22:05:29,549 [MainThread  ] Loaded supervised model
2020-04-30 22:05:29,550 [MainThread  ] Setup trainer for custom_un_image
2020-04-30 22:05:29,550 [MainThread  ] Start training custom_un_image
2020-04-30 22:05:31,888 [MainThread  ] train batch 1 / 32508 (iter 1), current average result {'loss': tensor(11.0877, grad_fn=<DivBackward0>), 'acc': tensor(0.)}
2020-04-30 22:05:31,888 [MainThread  ] Evaluate on  custom_un_image:val data
2020-04-30 22:05:32,604 [MainThread  ] eval batch 1 / 7560, current average result {'loss': tensor(12.3808), 'acc': tensor(0.)}
2020-04-30 22:05:33,082 [MainThread  ] eval batch 2 / 7560, current average result {'loss': tensor(12.2205), 'acc': tensor(0.)}
2020-04-30 22:05:33,542 [MainThread  ] eval batch 3 / 7560, current average result {'loss': tensor(12.2842), 'acc': tensor(0.)}
2020-04-30 22:05:34,003 [MainThread  ] eval batch 4 / 7560, current average result {'loss': tensor(12.1478), 'acc': tensor(0.)}
2020-04-30 22:05:34,465 [MainThread  ] eval batch 5 / 7560, current average result {'loss': tensor(12.3629), 'acc': tensor(0.)}
2020-04-30 22:05:34,930 [MainThread  ] eval batch 6 / 7560, current average result {'loss': tensor(12.3027), 'acc': tensor(0.)}
2020-04-30 22:05:35,386 [MainThread  ] eval batch 7 / 7560, current average result {'loss': tensor(12.4347), 'acc': tensor(0.)}
2020-04-30 22:05:35,843 [MainThread  ] eval batch 8 / 7560, current average result {'loss': tensor(12.5119), 'acc': tensor(0.)}
2020-04-30 22:05:36,309 [MainThread  ] eval batch 9 / 7560, current average result {'loss': tensor(12.5837), 'acc': tensor(0.)}
2020-04-30 22:05:36,789 [MainThread  ] eval batch 10 / 7560, current average result {'loss': tensor(12.5170), 'acc': tensor(0.)}
2020-04-30 22:05:37,255 [MainThread  ] eval batch 11 / 7560, current average result {'loss': tensor(12.5061), 'acc': tensor(0.)}
2020-04-30 22:05:53,791 [MainThread  ] Experiment debug
2020-04-30 22:05:53,791 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2000, finetune_weight_decay=1e-05, gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='pirl_nce_loss', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=40000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=1, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', synthesizer_nlayers=2, transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-04-30 22:05:53,791 [MainThread  ] Start creating tasks
2020-04-30 22:05:53,791 [MainThread  ] Start loading data
2020-04-30 22:05:53,791 [MainThread  ] Loading custom_un_image data
2020-04-30 22:05:53,792 [MainThread  ] Loading custom_sup data
2020-04-30 22:05:54,152 [MainThread  ] Start creating models
2020-04-30 22:05:54,387 [MainThread  ] Loaded image ssl model
2020-04-30 22:05:54,510 [MainThread  ] Loaded supervised model
2020-04-30 22:05:54,511 [MainThread  ] Setup trainer for custom_un_image
2020-04-30 22:05:54,511 [MainThread  ] Start training custom_un_image
2020-04-30 22:05:56,862 [MainThread  ] train batch 1 / 32508 (iter 1), current average result {'loss': tensor(12.2269, grad_fn=<DivBackward0>), 'acc': tensor(0.)}
2020-04-30 22:05:56,862 [MainThread  ] Evaluate on  custom_un_image:val data
2020-04-30 22:05:57,677 [MainThread  ] eval batch 1 / 7560, current average result {'loss': tensor(11.7319), 'acc': tensor(0.)}
2020-04-30 22:05:58,199 [MainThread  ] eval batch 2 / 7560, current average result {'loss': tensor(11.8391), 'acc': tensor(0.)}
2020-04-30 22:05:58,695 [MainThread  ] eval batch 3 / 7560, current average result {'loss': tensor(11.8444), 'acc': tensor(0.)}
2020-04-30 22:05:59,174 [MainThread  ] eval batch 4 / 7560, current average result {'loss': tensor(12.0360), 'acc': tensor(0.)}
2020-04-30 22:05:59,639 [MainThread  ] eval batch 5 / 7560, current average result {'loss': tensor(12.0455), 'acc': tensor(0.)}
2020-04-30 22:06:32,120 [MainThread  ] Evalutation complete
Average result {'loss': tensor(12.0455), 'acc': tensor(0.)}
2020-04-30 22:06:32,121 [MainThread  ] Best validation updated: {'best_iter': 1, 'best_performance': tensor(12.0455), 'current_iter': 1}
2020-04-30 22:06:32,160 [MainThread  ] Save parameters for ./results/debug/pretrain_custom_un_image_best.ckpt
2020-04-30 22:11:20,690 [MainThread  ] Experiment debug
2020-04-30 22:11:20,690 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2000, finetune_weight_decay=1e-05, gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='pirl_nce_loss', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=40000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=1, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', synthesizer_nlayers=2, transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-04-30 22:11:20,691 [MainThread  ] Start creating tasks
2020-04-30 22:11:20,691 [MainThread  ] Start loading data
2020-04-30 22:11:20,691 [MainThread  ] Loading custom_un_image data
2020-04-30 22:11:20,691 [MainThread  ] Loading custom_sup data
2020-04-30 22:11:21,094 [MainThread  ] Start creating models
2020-04-30 22:11:21,332 [MainThread  ] Loaded image ssl model
2020-04-30 22:11:21,469 [MainThread  ] Loaded supervised model
2020-04-30 22:11:21,470 [MainThread  ] Setup trainer for custom_un_image
2020-04-30 22:11:21,470 [MainThread  ] Start training custom_un_image
2020-04-30 22:11:24,098 [MainThread  ] train batch 1 / 32508 (iter 1), current average result {'loss': tensor(12.5750, grad_fn=<DivBackward0>), 'acc': tensor(0.)}
2020-04-30 22:11:24,099 [MainThread  ] Evaluate on  custom_un_image:val data
2020-04-30 22:11:53,133 [MainThread  ] Experiment debug
2020-04-30 22:11:53,134 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2000, finetune_weight_decay=1e-05, gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='pirl_nce_loss', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=40000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=1, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', synthesizer_nlayers=2, transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-04-30 22:11:53,134 [MainThread  ] Start creating tasks
2020-04-30 22:11:53,134 [MainThread  ] Start loading data
2020-04-30 22:11:53,134 [MainThread  ] Loading custom_un_image data
2020-04-30 22:11:53,135 [MainThread  ] Loading custom_sup data
2020-04-30 22:11:53,495 [MainThread  ] Start creating models
2020-04-30 22:11:53,727 [MainThread  ] Loaded image ssl model
2020-04-30 22:11:53,855 [MainThread  ] Loaded supervised model
2020-04-30 22:11:53,856 [MainThread  ] Setup trainer for custom_un_image
2020-04-30 22:11:53,857 [MainThread  ] Start training custom_un_image
2020-04-30 22:11:56,370 [MainThread  ] train batch 1 / 32508 (iter 1), current average result {'loss': tensor(11.4520, grad_fn=<DivBackward0>), 'acc': tensor(0.)}
2020-04-30 22:11:56,371 [MainThread  ] Evaluate on  custom_un_image:val data
2020-04-30 22:11:57,572 [MainThread  ] eval batch 1 / 7560, current average result {'loss': tensor(13.4108), 'acc': tensor(0.)}
2020-04-30 22:11:58,115 [MainThread  ] eval batch 2 / 7560, current average result {'loss': tensor(12.6203), 'acc': tensor(0.)}
2020-04-30 22:11:58,725 [MainThread  ] eval batch 3 / 7560, current average result {'loss': tensor(12.7063), 'acc': tensor(0.)}
2020-04-30 22:11:59,229 [MainThread  ] eval batch 4 / 7560, current average result {'loss': tensor(12.2768), 'acc': tensor(0.)}
2020-04-30 22:11:59,909 [MainThread  ] eval batch 5 / 7560, current average result {'loss': tensor(12.3212), 'acc': tensor(0.)}
2020-04-30 22:12:31,657 [MainThread  ] Evalutation complete
Average result {'loss': tensor(12.3212), 'acc': tensor(0.)}
2020-04-30 22:12:31,658 [MainThread  ] Best validation updated: {'best_iter': 1, 'best_performance': tensor(12.3212), 'current_iter': 1}
2020-04-30 22:12:31,694 [MainThread  ] Save parameters for ./results/debug/pretrain_custom_un_image_best.ckpt
2020-04-30 22:12:33,615 [MainThread  ] train batch 2 / 32508 (iter 2), current average result {'loss': tensor(12.6228, grad_fn=<DivBackward0>), 'acc': tensor(0.)}
2020-04-30 22:12:33,616 [MainThread  ] Evaluate on  custom_un_image:val data
2020-04-30 22:12:34,316 [MainThread  ] eval batch 1 / 7560, current average result {'loss': tensor(12.2763), 'acc': tensor(0.)}
2020-04-30 22:12:34,766 [MainThread  ] eval batch 2 / 7560, current average result {'loss': tensor(11.8803), 'acc': tensor(0.)}
2020-04-30 22:12:35,290 [MainThread  ] eval batch 3 / 7560, current average result {'loss': tensor(11.6891), 'acc': tensor(0.)}
2020-04-30 22:12:35,827 [MainThread  ] eval batch 4 / 7560, current average result {'loss': tensor(11.4594), 'acc': tensor(0.)}
2020-04-30 22:12:36,383 [MainThread  ] eval batch 5 / 7560, current average result {'loss': tensor(11.4624), 'acc': tensor(0.)}
2020-04-30 22:13:11,353 [MainThread  ] Evalutation complete
Average result {'loss': tensor(11.4624), 'acc': tensor(0.)}
2020-04-30 22:13:11,354 [MainThread  ] Best validation updated: {'best_iter': 2, 'best_performance': tensor(11.4624), 'current_iter': 2}
2020-04-30 22:13:11,392 [MainThread  ] Save parameters for ./results/debug/pretrain_custom_un_image_best.ckpt
2020-04-30 22:13:13,434 [MainThread  ] train batch 3 / 32508 (iter 3), current average result {'loss': tensor(12.1003, grad_fn=<DivBackward0>), 'acc': tensor(0.)}
2020-04-30 22:13:13,434 [MainThread  ] Evaluate on  custom_un_image:val data
2020-04-30 22:13:14,184 [MainThread  ] eval batch 1 / 7560, current average result {'loss': tensor(10.1699), 'acc': tensor(0.)}
2020-04-30 22:13:14,653 [MainThread  ] eval batch 2 / 7560, current average result {'loss': tensor(10.2820), 'acc': tensor(0.)}
2020-04-30 22:13:15,155 [MainThread  ] eval batch 3 / 7560, current average result {'loss': tensor(10.0400), 'acc': tensor(0.)}
2020-04-30 22:13:15,627 [MainThread  ] eval batch 4 / 7560, current average result {'loss': tensor(9.8761), 'acc': tensor(0.)}
2020-04-30 22:13:16,104 [MainThread  ] eval batch 5 / 7560, current average result {'loss': tensor(9.9150), 'acc': tensor(0.)}
2020-04-30 22:13:51,506 [MainThread  ] Evalutation complete
Average result {'loss': tensor(9.9150), 'acc': tensor(0.)}
2020-04-30 22:13:51,507 [MainThread  ] Best validation updated: {'best_iter': 3, 'best_performance': tensor(9.9150), 'current_iter': 3}
2020-04-30 22:13:51,578 [MainThread  ] Save parameters for ./results/debug/pretrain_custom_un_image_best.ckpt
2020-04-30 22:13:53,683 [MainThread  ] train batch 4 / 32508 (iter 4), current average result {'loss': tensor(12.7373, grad_fn=<DivBackward0>), 'acc': tensor(0.)}
2020-04-30 22:13:53,683 [MainThread  ] Evaluate on  custom_un_image:val data
2020-05-02 13:38:26,837 [MainThread  ] Experiment debug
2020-05-02 13:38:26,837 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', synthesizer_nlayers=2, transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 13:38:26,838 [MainThread  ] Start creating tasks
2020-05-02 13:38:26,838 [MainThread  ] Start loading data
2020-05-02 13:38:26,838 [MainThread  ] Loading custom_sup data
2020-05-02 13:38:27,206 [MainThread  ] Start creating models
2020-05-02 13:39:00,918 [MainThread  ] Experiment debug
2020-05-02 13:39:00,919 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', synthesizer_nlayers=2, transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 13:39:00,919 [MainThread  ] Start creating tasks
2020-05-02 13:39:00,919 [MainThread  ] Start loading data
2020-05-02 13:39:00,919 [MainThread  ] Loading custom_sup data
2020-05-02 13:39:01,282 [MainThread  ] Start creating models
2020-05-02 13:40:00,699 [MainThread  ] Experiment debug
2020-05-02 13:40:00,699 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', synthesizer_nlayers=2, transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 13:40:00,700 [MainThread  ] Start creating tasks
2020-05-02 13:40:00,700 [MainThread  ] Start loading data
2020-05-02 13:40:00,700 [MainThread  ] Loading custom_sup data
2020-05-02 13:40:01,153 [MainThread  ] Start creating models
2020-05-02 13:40:50,133 [MainThread  ] Experiment debug
2020-05-02 13:40:50,135 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', synthesizer_nlayers=2, transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 13:40:50,135 [MainThread  ] Start creating tasks
2020-05-02 13:40:50,135 [MainThread  ] Start loading data
2020-05-02 13:40:50,135 [MainThread  ] Loading custom_sup data
2020-05-02 13:40:50,508 [MainThread  ] Start creating models
2020-05-02 13:40:51,578 [MainThread  ] Loaded supervised model
2020-05-02 13:40:51,582 [MainThread  ] Setup trainer for custom_sup
2020-05-02 13:41:15,435 [MainThread  ] Experiment debug
2020-05-02 13:41:15,435 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', synthesizer_nlayers=2, transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 13:41:15,435 [MainThread  ] Start creating tasks
2020-05-02 13:41:15,435 [MainThread  ] Start loading data
2020-05-02 13:41:15,435 [MainThread  ] Loading custom_sup data
2020-05-02 13:41:15,795 [MainThread  ] Start creating models
2020-05-02 13:43:13,338 [MainThread  ] Experiment debug
2020-05-02 13:43:13,338 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', synthesizer_nlayers=2, transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 13:43:13,339 [MainThread  ] Start creating tasks
2020-05-02 13:43:13,339 [MainThread  ] Start loading data
2020-05-02 13:43:13,339 [MainThread  ] Loading custom_sup data
2020-05-02 13:43:13,702 [MainThread  ] Start creating models
2020-05-02 13:43:14,032 [MainThread  ] Loaded supervised model
2020-05-02 13:43:14,034 [MainThread  ] Setup trainer for custom_sup
2020-05-02 13:47:10,607 [MainThread  ] Experiment debug
2020-05-02 13:47:10,608 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', synthesizer_nlayers=2, transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 13:47:10,608 [MainThread  ] Start creating tasks
2020-05-02 13:47:10,608 [MainThread  ] Start loading data
2020-05-02 13:47:10,608 [MainThread  ] Loading custom_sup data
2020-05-02 13:47:10,973 [MainThread  ] Start creating models
2020-05-02 13:47:11,291 [MainThread  ] Loaded supervised model
2020-05-02 13:47:11,293 [MainThread  ] Setup trainer for custom_sup
2020-05-02 13:47:11,293 [MainThread  ] Start training custom_sup
2020-05-02 13:47:56,297 [MainThread  ] Experiment debug
2020-05-02 13:47:56,297 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', synthesizer_nlayers=2, transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 13:47:56,297 [MainThread  ] Start creating tasks
2020-05-02 13:47:56,297 [MainThread  ] Start loading data
2020-05-02 13:47:56,298 [MainThread  ] Loading custom_sup data
2020-05-02 13:47:56,686 [MainThread  ] Start creating models
2020-05-02 13:47:57,012 [MainThread  ] Loaded supervised model
2020-05-02 13:47:57,014 [MainThread  ] Setup trainer for custom_sup
2020-05-02 13:47:57,014 [MainThread  ] Start training custom_sup
2020-05-02 13:48:34,604 [MainThread  ] Experiment debug
2020-05-02 13:48:34,605 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', synthesizer_nlayers=2, transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 13:48:34,605 [MainThread  ] Start creating tasks
2020-05-02 13:48:34,605 [MainThread  ] Start loading data
2020-05-02 13:48:34,605 [MainThread  ] Loading custom_sup data
2020-05-02 13:48:34,969 [MainThread  ] Start creating models
2020-05-02 13:48:35,299 [MainThread  ] Loaded supervised model
2020-05-02 13:48:35,301 [MainThread  ] Setup trainer for custom_sup
2020-05-02 13:48:35,302 [MainThread  ] Start training custom_sup
2020-05-02 13:49:23,141 [MainThread  ] Experiment debug
2020-05-02 13:49:23,142 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', synthesizer_nlayers=2, transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 13:49:23,142 [MainThread  ] Start creating tasks
2020-05-02 13:49:23,143 [MainThread  ] Start loading data
2020-05-02 13:49:23,143 [MainThread  ] Loading custom_sup data
2020-05-02 13:49:23,528 [MainThread  ] Start creating models
2020-05-02 13:49:23,866 [MainThread  ] Loaded supervised model
2020-05-02 13:49:23,870 [MainThread  ] Setup trainer for custom_sup
2020-05-02 13:49:23,871 [MainThread  ] Start training custom_sup
2020-05-02 13:50:31,259 [MainThread  ] Experiment debug
2020-05-02 13:50:31,260 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', synthesizer_nlayers=2, transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 13:50:31,260 [MainThread  ] Start creating tasks
2020-05-02 13:50:31,260 [MainThread  ] Start loading data
2020-05-02 13:50:31,260 [MainThread  ] Loading custom_sup data
2020-05-02 13:50:31,617 [MainThread  ] Start creating models
2020-05-02 13:50:31,940 [MainThread  ] Loaded supervised model
2020-05-02 13:50:31,942 [MainThread  ] Setup trainer for custom_sup
2020-05-02 13:50:31,942 [MainThread  ] Start training custom_sup
2020-05-02 13:51:13,682 [MainThread  ] Experiment debug
2020-05-02 13:51:13,682 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', synthesizer_nlayers=2, transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 13:51:13,682 [MainThread  ] Start creating tasks
2020-05-02 13:51:13,683 [MainThread  ] Start loading data
2020-05-02 13:51:13,683 [MainThread  ] Loading custom_sup data
2020-05-02 13:51:14,058 [MainThread  ] Start creating models
2020-05-02 13:51:14,384 [MainThread  ] Loaded supervised model
2020-05-02 13:51:14,386 [MainThread  ] Setup trainer for custom_sup
2020-05-02 13:51:14,387 [MainThread  ] Start training custom_sup
2020-05-02 13:52:17,975 [MainThread  ] Experiment debug
2020-05-02 13:52:17,975 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', synthesizer_nlayers=2, transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 13:52:17,975 [MainThread  ] Start creating tasks
2020-05-02 13:52:17,976 [MainThread  ] Start loading data
2020-05-02 13:52:17,976 [MainThread  ] Loading custom_sup data
2020-05-02 13:52:18,350 [MainThread  ] Start creating models
2020-05-02 13:52:18,681 [MainThread  ] Loaded supervised model
2020-05-02 13:52:18,684 [MainThread  ] Setup trainer for custom_sup
2020-05-02 13:52:18,684 [MainThread  ] Start training custom_sup
2020-05-02 13:52:26,175 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.0833, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0833, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 13:52:32,018 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.0833, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0833, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 13:52:32,020 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-02 13:52:35,262 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 13:52:37,348 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 13:52:39,902 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 13:52:42,227 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 13:52:44,698 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 13:52:47,064 [MainThread  ] eval batch 6 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 13:52:49,129 [MainThread  ] eval batch 7 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 13:52:51,261 [MainThread  ] eval batch 8 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 13:52:53,493 [MainThread  ] eval batch 9 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 13:52:55,811 [MainThread  ] eval batch 10 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 13:52:58,024 [MainThread  ] eval batch 11 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 13:53:00,163 [MainThread  ] eval batch 12 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 13:53:11,583 [MainThread  ] Experiment debug
2020-05-02 13:53:11,583 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', synthesizer_nlayers=2, transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 13:53:11,584 [MainThread  ] Start creating tasks
2020-05-02 13:53:11,584 [MainThread  ] Start loading data
2020-05-02 13:53:11,584 [MainThread  ] Loading custom_sup data
2020-05-02 13:53:11,937 [MainThread  ] Start creating models
2020-05-02 13:53:12,257 [MainThread  ] Loaded supervised model
2020-05-02 13:53:12,260 [MainThread  ] Setup trainer for custom_sup
2020-05-02 13:53:12,260 [MainThread  ] Start training custom_sup
2020-05-02 13:53:19,141 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.0833, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0833, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 13:53:24,894 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.0833, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0833, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 13:53:24,895 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-02 13:53:28,113 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 13:53:30,564 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 13:53:32,851 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 13:53:35,418 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 13:53:37,787 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 13:53:45,184 [MainThread  ] Evalutation complete
Average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 13:53:45,186 [MainThread  ] Best validation updated: {'best_iter': 2, 'best_performance': tensor(0.0833), 'current_iter': 2}
2020-05-02 13:53:45,279 [MainThread  ] Save parameters for ./results/debug/finetune_custom_sup_best.ckpt
2020-05-02 13:53:51,727 [MainThread  ] train batch 3 / 1260 (iter 3), current average result {'loss': tensor(0.0833, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0833, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 13:53:57,776 [MainThread  ] train batch 4 / 1260 (iter 4), current average result {'loss': tensor(0.0832, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0832, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 13:53:57,776 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-02 13:54:01,192 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.0832), 'classification_loss': tensor(0.0832), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 13:54:03,439 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.0832), 'classification_loss': tensor(0.0832), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 13:54:05,615 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.0832), 'classification_loss': tensor(0.0832), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 13:54:08,370 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.0832), 'classification_loss': tensor(0.0832), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 13:54:10,698 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.0832), 'classification_loss': tensor(0.0832), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 13:54:17,767 [MainThread  ] Evalutation complete
Average result {'loss': tensor(0.0832), 'classification_loss': tensor(0.0832), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 13:54:17,769 [MainThread  ] Best validation updated: {'best_iter': 4, 'best_performance': tensor(0.0832), 'current_iter': 4}
2020-05-02 13:54:17,841 [MainThread  ] Save parameters for ./results/debug/finetune_custom_sup_best.ckpt
2020-05-02 13:54:23,887 [MainThread  ] train batch 5 / 1260 (iter 5), current average result {'loss': tensor(0.0832, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0832, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:08:51,159 [MainThread  ] Experiment debug
2020-05-02 19:08:51,160 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 19:08:51,160 [MainThread  ] Start creating tasks
2020-05-02 19:08:51,160 [MainThread  ] Start loading data
2020-05-02 19:08:51,160 [MainThread  ] Loading custom_sup data
2020-05-02 19:08:51,534 [MainThread  ] Start creating models
2020-05-02 19:08:51,889 [MainThread  ] Loaded supervised model
2020-05-02 19:08:51,892 [MainThread  ] Setup trainer for custom_sup
2020-05-02 19:08:51,892 [MainThread  ] Start training custom_sup
2020-05-02 19:08:59,913 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.0833, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0833, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:09:05,901 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.0833, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0833, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:09:05,902 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-02 19:09:09,384 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:09:11,485 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:09:13,656 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:09:15,883 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:09:18,052 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:09:24,138 [MainThread  ] Evalutation complete
Average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:09:24,140 [MainThread  ] Best validation updated: {'best_iter': 2, 'best_performance': tensor(0.0833), 'current_iter': 2}
2020-05-02 19:09:24,221 [MainThread  ] Save parameters for ./results/debug/finetune_custom_sup_best.ckpt
2020-05-02 19:09:30,509 [MainThread  ] train batch 3 / 1260 (iter 3), current average result {'loss': tensor(0.0833, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0833, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:09:36,488 [MainThread  ] train batch 4 / 1260 (iter 4), current average result {'loss': tensor(0.0832, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0832, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:09:36,488 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-02 19:09:39,751 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.0832), 'classification_loss': tensor(0.0832), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:09:41,851 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.0832), 'classification_loss': tensor(0.0832), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:09:43,947 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.0832), 'classification_loss': tensor(0.0832), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:09:46,108 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.0832), 'classification_loss': tensor(0.0832), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:10:12,107 [MainThread  ] Experiment debug
2020-05-02 19:10:12,107 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 19:10:12,108 [MainThread  ] Start creating tasks
2020-05-02 19:10:12,108 [MainThread  ] Start loading data
2020-05-02 19:10:12,108 [MainThread  ] Loading custom_sup data
2020-05-02 19:10:12,471 [MainThread  ] Start creating models
2020-05-02 19:10:12,797 [MainThread  ] Loaded supervised model
2020-05-02 19:10:12,799 [MainThread  ] Setup trainer for custom_sup
2020-05-02 19:10:12,799 [MainThread  ] Start training custom_sup
2020-05-02 19:10:19,711 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.0833, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0833, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:10:25,485 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.0833, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0833, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:10:25,485 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-02 19:10:28,856 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:10:30,924 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:10:32,987 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:10:35,096 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:10:37,206 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:10:43,376 [MainThread  ] Evalutation complete
Average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:10:43,378 [MainThread  ] Best validation updated: {'best_iter': 2, 'best_performance': tensor(0.0833), 'current_iter': 2}
2020-05-02 19:10:43,446 [MainThread  ] Save parameters for ./results/debug/finetune_custom_sup_best.ckpt
2020-05-02 19:10:49,469 [MainThread  ] train batch 3 / 1260 (iter 3), current average result {'loss': tensor(0.0833, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0833, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:10:55,217 [MainThread  ] train batch 4 / 1260 (iter 4), current average result {'loss': tensor(0.0832, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0832, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:10:55,218 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-02 19:10:58,289 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.0832), 'classification_loss': tensor(0.0832), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:11:00,431 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.0832), 'classification_loss': tensor(0.0832), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:11:02,503 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.0832), 'classification_loss': tensor(0.0832), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:11:21,155 [MainThread  ] Experiment debug
2020-05-02 19:11:21,155 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 19:11:21,155 [MainThread  ] Start creating tasks
2020-05-02 19:11:21,155 [MainThread  ] Start loading data
2020-05-02 19:11:21,155 [MainThread  ] Loading custom_sup data
2020-05-02 19:11:21,517 [MainThread  ] Start creating models
2020-05-02 19:11:21,840 [MainThread  ] Loaded supervised model
2020-05-02 19:11:21,842 [MainThread  ] Setup trainer for custom_sup
2020-05-02 19:11:21,842 [MainThread  ] Start training custom_sup
2020-05-02 19:11:28,771 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.0833, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0833, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:11:34,631 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.0833, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0833, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:11:34,631 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-02 19:11:37,707 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:11:39,766 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:11:41,838 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:11:43,945 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:11:46,003 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:11:52,056 [MainThread  ] Evalutation complete
Average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:11:52,057 [MainThread  ] Best validation updated: {'best_iter': 2, 'best_performance': tensor(0.0833), 'current_iter': 2}
2020-05-02 19:11:52,122 [MainThread  ] Save parameters for ./results/debug/finetune_custom_sup_best.ckpt
2020-05-02 19:12:58,120 [MainThread  ] Experiment debug
2020-05-02 19:12:58,120 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 19:12:58,121 [MainThread  ] Start creating tasks
2020-05-02 19:12:58,121 [MainThread  ] Start loading data
2020-05-02 19:12:58,121 [MainThread  ] Loading custom_sup data
2020-05-02 19:12:58,471 [MainThread  ] Start creating models
2020-05-02 19:12:58,789 [MainThread  ] Loaded supervised model
2020-05-02 19:12:58,791 [MainThread  ] Setup trainer for custom_sup
2020-05-02 19:12:58,791 [MainThread  ] Start training custom_sup
2020-05-02 19:13:05,551 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.0833, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0833, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:13:11,621 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.0833, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0833, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:13:11,622 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-02 19:13:15,606 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:13:17,748 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:13:19,835 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:13:21,914 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:13:24,010 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:13:29,651 [MainThread  ] Evalutation complete
Average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:13:29,653 [MainThread  ] Best validation updated: {'best_iter': 2, 'best_performance': tensor(0.0833), 'current_iter': 2}
2020-05-02 19:13:29,722 [MainThread  ] Save parameters for ./results/debug/finetune_custom_sup_best.ckpt
2020-05-02 19:13:35,698 [MainThread  ] train batch 3 / 1260 (iter 3), current average result {'loss': tensor(0.0833, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0833, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:18:35,382 [MainThread  ] Experiment debug
2020-05-02 19:18:35,382 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 19:18:35,382 [MainThread  ] Start creating tasks
2020-05-02 19:18:35,382 [MainThread  ] Start loading data
2020-05-02 19:18:35,382 [MainThread  ] Loading custom_sup data
2020-05-02 19:18:35,753 [MainThread  ] Start creating models
2020-05-02 19:18:36,079 [MainThread  ] Loaded supervised model
2020-05-02 19:18:36,081 [MainThread  ] Setup trainer for custom_sup
2020-05-02 19:18:36,081 [MainThread  ] Start training custom_sup
2020-05-02 19:18:43,142 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.0833, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0833, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:18:48,928 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.0833, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0833, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:18:48,928 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-02 19:18:52,001 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:18:54,101 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:18:56,205 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:18:58,325 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:19:00,398 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:19:06,165 [MainThread  ] Evalutation complete
Average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:19:06,167 [MainThread  ] Best validation updated: {'best_iter': 2, 'best_performance': tensor(0.0833), 'current_iter': 2}
2020-05-02 19:19:06,235 [MainThread  ] Save parameters for ./results/debug/finetune_custom_sup_best.ckpt
2020-05-02 19:19:12,391 [MainThread  ] train batch 3 / 1260 (iter 3), current average result {'loss': tensor(0.0833, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0833, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:20:39,239 [MainThread  ] Experiment debug
2020-05-02 19:20:39,239 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_views', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 19:20:39,239 [MainThread  ] Start creating tasks
2020-05-02 19:20:39,239 [MainThread  ] Start loading data
2020-05-02 19:20:39,239 [MainThread  ] Loading custom_sup data
2020-05-02 19:20:39,602 [MainThread  ] Start creating models
2020-05-02 19:20:39,820 [MainThread  ] Loaded supervised model
2020-05-02 19:20:39,823 [MainThread  ] Setup trainer for custom_sup
2020-05-02 19:20:39,823 [MainThread  ] Start training custom_sup
2020-05-02 19:20:51,787 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(1.3022, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.8161, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.4861, grad_fn=<DivBackward0>), 'ts_boxes': tensor(0.)}
2020-05-02 19:21:00,362 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.9009, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.6578, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.2431, grad_fn=<DivBackward0>), 'ts_boxes': tensor(0.)}
2020-05-02 19:21:00,363 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-02 19:24:58,375 [MainThread  ] Experiment debug
2020-05-02 19:24:58,376 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_views', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 19:24:58,376 [MainThread  ] Start creating tasks
2020-05-02 19:24:58,376 [MainThread  ] Start loading data
2020-05-02 19:24:58,376 [MainThread  ] Loading custom_sup data
2020-05-02 19:24:58,732 [MainThread  ] Start creating models
2020-05-02 19:24:58,948 [MainThread  ] Loaded supervised model
2020-05-02 19:24:58,950 [MainThread  ] Setup trainer for custom_sup
2020-05-02 19:24:58,951 [MainThread  ] Start training custom_sup
2020-05-02 19:25:11,667 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(1.2567, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.8347, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.4220, grad_fn=<DivBackward0>), 'ts_boxes': tensor(0.)}
2020-05-02 19:25:20,536 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.8781, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.6671, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.2110, grad_fn=<DivBackward0>), 'ts_boxes': tensor(0.)}
2020-05-02 19:25:20,537 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-02 19:25:25,396 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.4989), 'classification_loss': tensor(0.4989), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:25:29,005 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.4989), 'classification_loss': tensor(0.4989), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:25:32,550 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.4989), 'classification_loss': tensor(0.4989), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:25:36,110 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.4989), 'classification_loss': tensor(0.4989), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:25:39,742 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.4989), 'classification_loss': tensor(0.4989), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:25:45,783 [MainThread  ] Evalutation complete
Average result {'loss': tensor(0.4989), 'classification_loss': tensor(0.4989), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:25:45,785 [MainThread  ] Best validation updated: {'best_iter': 2, 'best_performance': tensor(0.4989), 'current_iter': 2}
2020-05-02 19:25:45,829 [MainThread  ] Save parameters for ./results/debug/finetune_custom_sup_best.ckpt
2020-05-02 19:25:54,685 [MainThread  ] train batch 3 / 1260 (iter 3), current average result {'loss': tensor(0.4989, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.4989, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:26:03,358 [MainThread  ] train batch 4 / 1260 (iter 4), current average result {'loss': tensor(0.4983, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.4983, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:26:03,358 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-02 19:26:08,032 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.4970), 'classification_loss': tensor(0.4970), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:26:11,587 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.4970), 'classification_loss': tensor(0.4970), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:26:15,154 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.4970), 'classification_loss': tensor(0.4970), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:26:18,721 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.4970), 'classification_loss': tensor(0.4970), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:26:22,345 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.4970), 'classification_loss': tensor(0.4970), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:26:28,119 [MainThread  ] Evalutation complete
Average result {'loss': tensor(0.4970), 'classification_loss': tensor(0.4970), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:26:28,121 [MainThread  ] Best validation updated: {'best_iter': 4, 'best_performance': tensor(0.4970), 'current_iter': 4}
2020-05-02 19:26:28,166 [MainThread  ] Save parameters for ./results/debug/finetune_custom_sup_best.ckpt
2020-05-02 19:26:42,277 [MainThread  ] Experiment debug
2020-05-02 19:26:42,277 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 19:26:42,277 [MainThread  ] Start creating tasks
2020-05-02 19:26:42,277 [MainThread  ] Start loading data
2020-05-02 19:26:42,277 [MainThread  ] Loading custom_sup data
2020-05-02 19:26:42,644 [MainThread  ] Start creating models
2020-05-02 19:26:42,959 [MainThread  ] Loaded supervised model
2020-05-02 19:26:42,961 [MainThread  ] Setup trainer for custom_sup
2020-05-02 19:26:42,961 [MainThread  ] Start training custom_sup
2020-05-02 19:26:50,163 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(1.1073, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.6081, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.4992, grad_fn=<DivBackward0>), 'ts_boxes': tensor(0.)}
2020-05-02 19:26:56,010 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.5953, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.3457, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.2496, grad_fn=<DivBackward0>), 'ts_boxes': tensor(0.)}
2020-05-02 19:26:56,010 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-02 19:26:59,334 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:27:01,428 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:27:03,498 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:27:05,548 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:27:07,642 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:27:13,405 [MainThread  ] Evalutation complete
Average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:27:13,408 [MainThread  ] Best validation updated: {'best_iter': 2, 'best_performance': tensor(0.0833), 'current_iter': 2}
2020-05-02 19:27:13,476 [MainThread  ] Save parameters for ./results/debug/finetune_custom_sup_best.ckpt
2020-05-02 19:27:33,568 [MainThread  ] Experiment debug
2020-05-02 19:27:33,568 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_views', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 19:27:33,568 [MainThread  ] Start creating tasks
2020-05-02 19:27:33,568 [MainThread  ] Start loading data
2020-05-02 19:27:33,568 [MainThread  ] Loading custom_sup data
2020-05-02 19:27:33,942 [MainThread  ] Start creating models
2020-05-02 19:27:34,152 [MainThread  ] Loaded supervised model
2020-05-02 19:27:34,154 [MainThread  ] Setup trainer for custom_sup
2020-05-02 19:27:34,154 [MainThread  ] Start training custom_sup
2020-05-02 19:34:40,071 [MainThread  ] Experiment debug
2020-05-02 19:34:40,071 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_views', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 19:34:40,071 [MainThread  ] Start creating tasks
2020-05-02 19:34:40,072 [MainThread  ] Start loading data
2020-05-02 19:34:40,072 [MainThread  ] Loading custom_sup data
2020-05-02 19:34:40,432 [MainThread  ] Start creating models
2020-05-02 19:34:40,647 [MainThread  ] Loaded supervised model
2020-05-02 19:34:40,648 [MainThread  ] Setup trainer for custom_sup
2020-05-02 19:34:40,649 [MainThread  ] Start training custom_sup
2020-05-02 19:37:21,978 [MainThread  ] Experiment debug
2020-05-02 19:37:21,978 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_views', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 19:37:21,978 [MainThread  ] Start creating tasks
2020-05-02 19:37:21,978 [MainThread  ] Start loading data
2020-05-02 19:37:21,979 [MainThread  ] Loading custom_sup data
2020-05-02 19:37:22,359 [MainThread  ] Start creating models
2020-05-02 19:37:22,580 [MainThread  ] Loaded supervised model
2020-05-02 19:37:22,582 [MainThread  ] Setup trainer for custom_sup
2020-05-02 19:37:22,582 [MainThread  ] Start training custom_sup
2020-05-02 19:37:32,639 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.4996, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.4996, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:37:38,993 [MainThread  ] Experiment debug
2020-05-02 19:37:38,993 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 19:37:38,993 [MainThread  ] Start creating tasks
2020-05-02 19:37:38,994 [MainThread  ] Start loading data
2020-05-02 19:37:38,994 [MainThread  ] Loading custom_sup data
2020-05-02 19:37:39,361 [MainThread  ] Start creating models
2020-05-02 19:37:39,682 [MainThread  ] Loaded supervised model
2020-05-02 19:37:39,684 [MainThread  ] Setup trainer for custom_sup
2020-05-02 19:37:39,684 [MainThread  ] Start training custom_sup
2020-05-02 19:37:46,525 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.0833, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0833, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-02 19:43:33,985 [MainThread  ] Experiment debug
2020-05-02 19:43:33,985 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 19:43:33,985 [MainThread  ] Start creating tasks
2020-05-02 19:43:33,985 [MainThread  ] Start loading data
2020-05-02 19:43:33,986 [MainThread  ] Loading custom_sup data
2020-05-02 19:43:34,372 [MainThread  ] Start creating models
2020-05-02 19:45:19,807 [MainThread  ] Experiment debug
2020-05-02 19:45:19,808 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 19:45:19,808 [MainThread  ] Start creating tasks
2020-05-02 19:45:19,808 [MainThread  ] Start loading data
2020-05-02 19:45:19,808 [MainThread  ] Loading custom_sup data
2020-05-02 19:45:20,188 [MainThread  ] Start creating models
2020-05-02 19:47:54,740 [MainThread  ] Experiment debug
2020-05-02 19:47:54,740 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='convconcat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 19:47:54,741 [MainThread  ] Start creating tasks
2020-05-02 19:47:54,741 [MainThread  ] Start loading data
2020-05-02 19:47:54,741 [MainThread  ] Loading custom_sup data
2020-05-02 19:47:55,122 [MainThread  ] Start creating models
2020-05-02 19:48:45,583 [MainThread  ] Experiment debug
2020-05-02 19:48:45,584 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='convconcat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 19:48:45,584 [MainThread  ] Start creating tasks
2020-05-02 19:48:45,584 [MainThread  ] Start loading data
2020-05-02 19:48:45,584 [MainThread  ] Loading custom_sup data
2020-05-02 19:48:45,961 [MainThread  ] Start creating models
2020-05-02 19:50:37,120 [MainThread  ] Experiment debug
2020-05-02 19:50:37,121 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='convconcat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 19:50:37,121 [MainThread  ] Start creating tasks
2020-05-02 19:50:37,121 [MainThread  ] Start loading data
2020-05-02 19:50:37,121 [MainThread  ] Loading custom_sup data
2020-05-02 19:50:37,481 [MainThread  ] Start creating models
2020-05-02 19:50:54,536 [MainThread  ] Experiment debug
2020-05-02 19:50:54,536 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='convconcat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 19:50:54,536 [MainThread  ] Start creating tasks
2020-05-02 19:50:54,536 [MainThread  ] Start loading data
2020-05-02 19:50:54,536 [MainThread  ] Loading custom_sup data
2020-05-02 19:50:54,897 [MainThread  ] Start creating models
2020-05-02 19:51:30,439 [MainThread  ] Experiment debug
2020-05-02 19:51:30,440 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 19:51:30,440 [MainThread  ] Start creating tasks
2020-05-02 19:51:30,440 [MainThread  ] Start loading data
2020-05-02 19:51:30,440 [MainThread  ] Loading custom_sup data
2020-05-02 19:51:30,805 [MainThread  ] Start creating models
2020-05-02 19:55:38,068 [MainThread  ] Experiment debug
2020-05-02 19:55:38,069 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 19:55:38,070 [MainThread  ] Start creating tasks
2020-05-02 19:55:38,070 [MainThread  ] Start loading data
2020-05-02 19:55:38,070 [MainThread  ] Loading custom_sup data
2020-05-02 19:55:38,443 [MainThread  ] Start creating models
2020-05-02 19:56:32,917 [MainThread  ] Experiment debug
2020-05-02 19:56:32,918 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 19:56:32,918 [MainThread  ] Start creating tasks
2020-05-02 19:56:32,918 [MainThread  ] Start loading data
2020-05-02 19:56:32,918 [MainThread  ] Loading custom_sup data
2020-05-02 19:56:33,284 [MainThread  ] Start creating models
2020-05-02 19:56:46,593 [MainThread  ] Experiment debug
2020-05-02 19:56:46,593 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 19:56:46,593 [MainThread  ] Start creating tasks
2020-05-02 19:56:46,593 [MainThread  ] Start loading data
2020-05-02 19:56:46,593 [MainThread  ] Loading custom_sup data
2020-05-02 19:56:46,946 [MainThread  ] Start creating models
2020-05-02 19:57:24,878 [MainThread  ] Experiment debug
2020-05-02 19:57:24,878 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 19:57:24,878 [MainThread  ] Start creating tasks
2020-05-02 19:57:24,878 [MainThread  ] Start loading data
2020-05-02 19:57:24,878 [MainThread  ] Loading custom_sup data
2020-05-02 19:57:25,227 [MainThread  ] Start creating models
2020-05-02 19:58:31,484 [MainThread  ] Experiment debug
2020-05-02 19:58:31,484 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 19:58:31,485 [MainThread  ] Start creating tasks
2020-05-02 19:58:31,485 [MainThread  ] Start loading data
2020-05-02 19:58:31,485 [MainThread  ] Loading custom_sup data
2020-05-02 19:58:31,840 [MainThread  ] Start creating models
2020-05-02 19:58:33,112 [MainThread  ] Loaded supervised model
2020-05-02 19:58:33,115 [MainThread  ] Setup trainer for custom_sup
2020-05-02 19:58:33,115 [MainThread  ] Start training custom_sup
2020-05-02 19:59:05,876 [MainThread  ] Experiment debug
2020-05-02 19:59:05,876 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 19:59:05,877 [MainThread  ] Start creating tasks
2020-05-02 19:59:05,877 [MainThread  ] Start loading data
2020-05-02 19:59:05,877 [MainThread  ] Loading custom_sup data
2020-05-02 19:59:06,239 [MainThread  ] Start creating models
2020-05-02 19:59:07,544 [MainThread  ] Loaded supervised model
2020-05-02 19:59:07,546 [MainThread  ] Setup trainer for custom_sup
2020-05-02 19:59:07,546 [MainThread  ] Start training custom_sup
2020-05-02 20:00:11,445 [MainThread  ] Experiment debug
2020-05-02 20:00:11,446 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 20:00:11,446 [MainThread  ] Start creating tasks
2020-05-02 20:00:11,446 [MainThread  ] Start loading data
2020-05-02 20:00:11,446 [MainThread  ] Loading custom_sup data
2020-05-02 20:00:11,791 [MainThread  ] Start creating models
2020-05-02 20:00:13,103 [MainThread  ] Loaded supervised model
2020-05-02 20:00:13,105 [MainThread  ] Setup trainer for custom_sup
2020-05-02 20:00:13,105 [MainThread  ] Start training custom_sup
2020-05-02 20:02:49,109 [MainThread  ] Experiment debug
2020-05-02 20:02:49,109 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 20:02:49,109 [MainThread  ] Start creating tasks
2020-05-02 20:02:49,110 [MainThread  ] Start loading data
2020-05-02 20:02:49,110 [MainThread  ] Loading custom_sup data
2020-05-02 20:02:49,467 [MainThread  ] Start creating models
2020-05-02 20:02:50,850 [MainThread  ] Loaded supervised model
2020-05-02 20:02:50,852 [MainThread  ] Setup trainer for custom_sup
2020-05-02 20:02:50,852 [MainThread  ] Start training custom_sup
2020-05-02 20:05:04,956 [MainThread  ] Experiment debug
2020-05-02 20:05:04,956 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 20:05:04,956 [MainThread  ] Start creating tasks
2020-05-02 20:05:04,956 [MainThread  ] Start loading data
2020-05-02 20:05:04,956 [MainThread  ] Loading custom_sup data
2020-05-02 20:05:05,312 [MainThread  ] Start creating models
2020-05-02 20:05:06,626 [MainThread  ] Loaded supervised model
2020-05-02 20:05:06,628 [MainThread  ] Setup trainer for custom_sup
2020-05-02 20:05:06,628 [MainThread  ] Start training custom_sup
2020-05-02 20:06:03,327 [MainThread  ] Experiment debug
2020-05-02 20:06:03,327 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 20:06:03,328 [MainThread  ] Start creating tasks
2020-05-02 20:06:03,328 [MainThread  ] Start loading data
2020-05-02 20:06:03,328 [MainThread  ] Loading custom_sup data
2020-05-02 20:06:03,686 [MainThread  ] Start creating models
2020-05-02 20:06:04,976 [MainThread  ] Loaded supervised model
2020-05-02 20:06:04,977 [MainThread  ] Setup trainer for custom_sup
2020-05-02 20:06:04,977 [MainThread  ] Start training custom_sup
2020-05-02 20:06:49,231 [MainThread  ] Experiment debug
2020-05-02 20:06:49,231 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 20:06:49,232 [MainThread  ] Start creating tasks
2020-05-02 20:06:49,232 [MainThread  ] Start loading data
2020-05-02 20:06:49,232 [MainThread  ] Loading custom_sup data
2020-05-02 20:06:49,602 [MainThread  ] Start creating models
2020-05-02 20:06:50,990 [MainThread  ] Loaded supervised model
2020-05-02 20:06:50,991 [MainThread  ] Setup trainer for custom_sup
2020-05-02 20:06:50,992 [MainThread  ] Start training custom_sup
2020-05-02 20:07:02,204 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.7222, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7222, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.3025, grad_fn=<DivBackward0>)}
2020-05-02 20:07:12,661 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.7195, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7195, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.3084, grad_fn=<DivBackward0>)}
2020-05-02 20:07:12,662 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-02 20:07:15,701 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.7108), 'recon_loss': tensor(0.7108), 'ts_road_map': tensor(0.3296)}
2020-05-02 20:07:17,163 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.7113), 'recon_loss': tensor(0.7113), 'ts_road_map': tensor(0.3304)}
2020-05-02 20:07:18,605 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.7116), 'recon_loss': tensor(0.7116), 'ts_road_map': tensor(0.3310)}
2020-05-02 20:07:20,045 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.7119), 'recon_loss': tensor(0.7119), 'ts_road_map': tensor(0.3315)}
2020-05-02 20:12:00,156 [MainThread  ] Experiment debug
2020-05-02 20:12:00,156 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dense_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 20:12:00,157 [MainThread  ] Start creating tasks
2020-05-02 20:12:00,157 [MainThread  ] Start loading data
2020-05-02 20:12:00,157 [MainThread  ] Loading custom_sup data
2020-05-02 20:12:00,514 [MainThread  ] Start creating models
2020-05-02 20:12:23,358 [MainThread  ] Experiment debug
2020-05-02 20:12:23,359 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dense_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 20:12:23,359 [MainThread  ] Start creating tasks
2020-05-02 20:12:23,359 [MainThread  ] Start loading data
2020-05-02 20:12:23,359 [MainThread  ] Loading custom_sup data
2020-05-02 20:12:23,724 [MainThread  ] Start creating models
2020-05-02 20:13:00,142 [MainThread  ] Experiment debug
2020-05-02 20:13:00,142 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dense_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 20:13:00,142 [MainThread  ] Start creating tasks
2020-05-02 20:13:00,143 [MainThread  ] Start loading data
2020-05-02 20:13:00,143 [MainThread  ] Loading custom_sup data
2020-05-02 20:13:00,517 [MainThread  ] Start creating models
2020-05-02 20:13:00,775 [MainThread  ] Loaded supervised model
2020-05-02 20:13:00,776 [MainThread  ] Setup trainer for custom_sup
2020-05-02 20:13:00,777 [MainThread  ] Start training custom_sup
2020-05-02 20:15:18,944 [MainThread  ] Experiment debug
2020-05-02 20:15:18,945 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dense_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 20:15:18,945 [MainThread  ] Start creating tasks
2020-05-02 20:15:18,945 [MainThread  ] Start loading data
2020-05-02 20:15:18,945 [MainThread  ] Loading custom_sup data
2020-05-02 20:15:19,310 [MainThread  ] Start creating models
2020-05-02 20:38:59,988 [MainThread  ] Experiment debug
2020-05-02 20:38:59,989 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dense_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 20:38:59,989 [MainThread  ] Start creating tasks
2020-05-02 20:38:59,989 [MainThread  ] Start loading data
2020-05-02 20:38:59,989 [MainThread  ] Loading custom_sup data
2020-05-02 20:39:00,457 [MainThread  ] Start creating models
2020-05-02 20:39:00,737 [MainThread  ] Loaded supervised model
2020-05-02 20:39:00,739 [MainThread  ] Setup trainer for custom_sup
2020-05-02 20:39:00,739 [MainThread  ] Start training custom_sup
2020-05-02 20:42:34,931 [MainThread  ] Experiment debug
2020-05-02 20:42:34,932 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dense_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 20:42:34,932 [MainThread  ] Start creating tasks
2020-05-02 20:42:34,932 [MainThread  ] Start loading data
2020-05-02 20:42:34,932 [MainThread  ] Loading custom_sup data
2020-05-02 20:42:35,291 [MainThread  ] Start creating models
2020-05-02 20:42:35,556 [MainThread  ] Loaded supervised model
2020-05-02 20:42:35,558 [MainThread  ] Setup trainer for custom_sup
2020-05-02 20:42:35,558 [MainThread  ] Start training custom_sup
2020-05-02 20:46:43,793 [MainThread  ] Experiment debug
2020-05-02 20:46:43,793 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dense_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 20:46:43,793 [MainThread  ] Start creating tasks
2020-05-02 20:46:43,794 [MainThread  ] Start loading data
2020-05-02 20:46:43,794 [MainThread  ] Loading custom_sup data
2020-05-02 20:46:44,151 [MainThread  ] Start creating models
2020-05-02 20:46:44,409 [MainThread  ] Loaded supervised model
2020-05-02 20:46:44,410 [MainThread  ] Setup trainer for custom_sup
2020-05-02 20:46:44,410 [MainThread  ] Start training custom_sup
2020-05-02 20:48:34,744 [MainThread  ] Experiment debug
2020-05-02 20:48:34,745 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dense_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 20:48:34,745 [MainThread  ] Start creating tasks
2020-05-02 20:48:34,745 [MainThread  ] Start loading data
2020-05-02 20:48:34,745 [MainThread  ] Loading custom_sup data
2020-05-02 20:48:35,126 [MainThread  ] Start creating models
2020-05-02 20:48:35,385 [MainThread  ] Loaded supervised model
2020-05-02 20:48:35,387 [MainThread  ] Setup trainer for custom_sup
2020-05-02 20:48:35,388 [MainThread  ] Start training custom_sup
2020-05-02 20:49:01,914 [MainThread  ] Experiment debug
2020-05-02 20:49:01,914 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dense_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 20:49:01,914 [MainThread  ] Start creating tasks
2020-05-02 20:49:01,914 [MainThread  ] Start loading data
2020-05-02 20:49:01,914 [MainThread  ] Loading custom_sup data
2020-05-02 20:49:02,282 [MainThread  ] Start creating models
2020-05-02 20:49:02,543 [MainThread  ] Loaded supervised model
2020-05-02 20:49:02,544 [MainThread  ] Setup trainer for custom_sup
2020-05-02 20:49:02,545 [MainThread  ] Start training custom_sup
2020-05-02 20:49:07,407 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.7307, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7307, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.3016, grad_fn=<DivBackward0>)}
2020-05-02 20:49:11,042 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.7377, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7377, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2838, grad_fn=<DivBackward0>)}
2020-05-02 20:49:11,042 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-02 20:49:13,230 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.6908), 'recon_loss': tensor(0.6908), 'ts_road_map': tensor(0.3635)}
2020-05-02 20:49:14,144 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.6907), 'recon_loss': tensor(0.6907), 'ts_road_map': tensor(0.3645)}
2020-05-02 20:49:15,038 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.6906), 'recon_loss': tensor(0.6906), 'ts_road_map': tensor(0.3653)}
2020-05-02 20:49:15,921 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.6905), 'recon_loss': tensor(0.6905), 'ts_road_map': tensor(0.3659)}
2020-05-02 20:49:16,802 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.6905), 'recon_loss': tensor(0.6905), 'ts_road_map': tensor(0.3663)}
2020-05-02 20:49:22,413 [MainThread  ] Evalutation complete
Average result {'loss': tensor(0.6905), 'recon_loss': tensor(0.6905), 'ts_road_map': tensor(0.3663)}
2020-05-02 20:49:22,415 [MainThread  ] Best validation updated: {'best_iter': 2, 'best_performance': tensor(0.6905), 'current_iter': 2}
2020-05-02 20:49:22,464 [MainThread  ] Save parameters for ./results/debug/finetune_custom_sup_best.ckpt
2020-05-02 20:49:26,152 [MainThread  ] train batch 3 / 1260 (iter 3), current average result {'loss': tensor(0.7326, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7326, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2940, grad_fn=<DivBackward0>)}
2020-05-02 20:49:40,799 [MainThread  ] Experiment debug
2020-05-02 20:49:40,799 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dproject_dense_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 20:49:40,800 [MainThread  ] Start creating tasks
2020-05-02 20:49:40,800 [MainThread  ] Start loading data
2020-05-02 20:49:40,800 [MainThread  ] Loading custom_sup data
2020-05-02 20:49:41,166 [MainThread  ] Start creating models
2020-05-02 20:49:53,273 [MainThread  ] Experiment debug
2020-05-02 20:49:53,273 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dproject_dense_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 20:49:53,273 [MainThread  ] Start creating tasks
2020-05-02 20:49:53,273 [MainThread  ] Start loading data
2020-05-02 20:49:53,274 [MainThread  ] Loading custom_sup data
2020-05-02 20:49:53,623 [MainThread  ] Start creating models
2020-05-02 20:49:53,876 [MainThread  ] Loaded supervised model
2020-05-02 20:49:53,877 [MainThread  ] Setup trainer for custom_sup
2020-05-02 20:49:53,878 [MainThread  ] Start training custom_sup
2020-05-02 20:52:25,997 [MainThread  ] Experiment debug
2020-05-02 20:52:25,998 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dproject_dense_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 20:52:25,998 [MainThread  ] Start creating tasks
2020-05-02 20:52:25,998 [MainThread  ] Start loading data
2020-05-02 20:52:25,998 [MainThread  ] Loading custom_sup data
2020-05-02 20:52:26,351 [MainThread  ] Start creating models
2020-05-02 20:52:26,607 [MainThread  ] Loaded supervised model
2020-05-02 20:52:26,609 [MainThread  ] Setup trainer for custom_sup
2020-05-02 20:52:26,609 [MainThread  ] Start training custom_sup
2020-05-02 20:53:03,512 [MainThread  ] Experiment debug
2020-05-02 20:53:03,512 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dproject_dense_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 20:53:03,512 [MainThread  ] Start creating tasks
2020-05-02 20:53:03,512 [MainThread  ] Start loading data
2020-05-02 20:53:03,512 [MainThread  ] Loading custom_sup data
2020-05-02 20:53:03,860 [MainThread  ] Start creating models
2020-05-02 20:53:04,117 [MainThread  ] Loaded supervised model
2020-05-02 20:53:04,119 [MainThread  ] Setup trainer for custom_sup
2020-05-02 20:53:04,119 [MainThread  ] Start training custom_sup
2020-05-02 20:53:56,874 [MainThread  ] Experiment debug
2020-05-02 20:53:56,874 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dproject_dense_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 20:53:56,875 [MainThread  ] Start creating tasks
2020-05-02 20:53:56,875 [MainThread  ] Start loading data
2020-05-02 20:53:56,875 [MainThread  ] Loading custom_sup data
2020-05-02 20:53:57,225 [MainThread  ] Start creating models
2020-05-02 20:53:57,478 [MainThread  ] Loaded supervised model
2020-05-02 20:53:57,480 [MainThread  ] Setup trainer for custom_sup
2020-05-02 20:53:57,480 [MainThread  ] Start training custom_sup
2020-05-02 20:55:46,567 [MainThread  ] Experiment debug
2020-05-02 20:55:46,567 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dproject_dense_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 20:55:46,567 [MainThread  ] Start creating tasks
2020-05-02 20:55:46,567 [MainThread  ] Start loading data
2020-05-02 20:55:46,567 [MainThread  ] Loading custom_sup data
2020-05-02 20:55:46,922 [MainThread  ] Start creating models
2020-05-02 20:55:47,173 [MainThread  ] Loaded supervised model
2020-05-02 20:55:47,174 [MainThread  ] Setup trainer for custom_sup
2020-05-02 20:55:47,174 [MainThread  ] Start training custom_sup
2020-05-02 20:56:10,678 [MainThread  ] Experiment debug
2020-05-02 20:56:10,679 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dproject_dense_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 20:56:10,679 [MainThread  ] Start creating tasks
2020-05-02 20:56:10,679 [MainThread  ] Start loading data
2020-05-02 20:56:10,679 [MainThread  ] Loading custom_sup data
2020-05-02 20:56:11,042 [MainThread  ] Start creating models
2020-05-02 20:56:11,298 [MainThread  ] Loaded supervised model
2020-05-02 20:56:11,300 [MainThread  ] Setup trainer for custom_sup
2020-05-02 20:56:11,300 [MainThread  ] Start training custom_sup
2020-05-02 20:56:17,065 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.7124, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7124, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2678, grad_fn=<DivBackward0>)}
2020-05-02 20:56:20,923 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.7169, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7169, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2909, grad_fn=<DivBackward0>)}
2020-05-02 20:56:20,924 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-02 20:56:23,333 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.6955), 'recon_loss': tensor(0.6955), 'ts_road_map': tensor(0.3524)}
2020-05-02 20:56:24,202 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.6956), 'recon_loss': tensor(0.6956), 'ts_road_map': tensor(0.3533)}
2020-05-02 20:56:25,158 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.6957), 'recon_loss': tensor(0.6957), 'ts_road_map': tensor(0.3541)}
2020-05-02 20:56:26,058 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.6957), 'recon_loss': tensor(0.6957), 'ts_road_map': tensor(0.3546)}
2020-05-02 20:56:26,937 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.6958), 'recon_loss': tensor(0.6958), 'ts_road_map': tensor(0.3550)}
2020-05-02 20:57:12,627 [MainThread  ] Experiment debug
2020-05-02 20:57:12,627 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dproject_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 20:57:12,627 [MainThread  ] Start creating tasks
2020-05-02 20:57:12,627 [MainThread  ] Start loading data
2020-05-02 20:57:12,627 [MainThread  ] Loading custom_sup data
2020-05-02 20:57:13,001 [MainThread  ] Start creating models
2020-05-02 20:57:14,252 [MainThread  ] Loaded supervised model
2020-05-02 20:57:14,254 [MainThread  ] Setup trainer for custom_sup
2020-05-02 20:57:14,254 [MainThread  ] Start training custom_sup
2020-05-02 21:19:07,281 [MainThread  ] Experiment debug
2020-05-02 21:19:07,282 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dproject_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 21:19:07,282 [MainThread  ] Start creating tasks
2020-05-02 21:19:07,283 [MainThread  ] Start loading data
2020-05-02 21:19:07,283 [MainThread  ] Loading custom_sup data
2020-05-02 21:19:07,644 [MainThread  ] Start creating models
2020-05-02 21:19:07,906 [MainThread  ] Loaded supervised model
2020-05-02 21:19:07,908 [MainThread  ] Setup trainer for custom_sup
2020-05-02 21:19:07,908 [MainThread  ] Start training custom_sup
2020-05-02 21:19:20,473 [MainThread  ] Experiment debug
2020-05-02 21:19:20,473 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dproject_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 21:19:20,474 [MainThread  ] Start creating tasks
2020-05-02 21:19:20,474 [MainThread  ] Start loading data
2020-05-02 21:19:20,474 [MainThread  ] Loading custom_sup data
2020-05-02 21:19:20,827 [MainThread  ] Start creating models
2020-05-02 21:19:21,087 [MainThread  ] Loaded supervised model
2020-05-02 21:19:21,089 [MainThread  ] Setup trainer for custom_sup
2020-05-02 21:19:21,089 [MainThread  ] Start training custom_sup
2020-05-02 21:23:03,799 [MainThread  ] Experiment debug
2020-05-02 21:23:03,800 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dproject_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 21:23:03,800 [MainThread  ] Start creating tasks
2020-05-02 21:23:03,800 [MainThread  ] Start loading data
2020-05-02 21:23:03,801 [MainThread  ] Loading custom_sup data
2020-05-02 21:23:04,170 [MainThread  ] Start creating models
2020-05-02 21:23:04,438 [MainThread  ] Loaded supervised model
2020-05-02 21:23:04,440 [MainThread  ] Setup trainer for custom_sup
2020-05-02 21:23:04,441 [MainThread  ] Start training custom_sup
2020-05-02 21:28:43,152 [MainThread  ] Experiment debug
2020-05-02 21:28:43,153 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dproject_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 21:28:43,153 [MainThread  ] Start creating tasks
2020-05-02 21:28:43,153 [MainThread  ] Start loading data
2020-05-02 21:28:43,153 [MainThread  ] Loading custom_sup data
2020-05-02 21:28:43,505 [MainThread  ] Start creating models
2020-05-02 21:28:43,773 [MainThread  ] Loaded supervised model
2020-05-02 21:28:43,775 [MainThread  ] Setup trainer for custom_sup
2020-05-02 21:28:43,775 [MainThread  ] Start training custom_sup
2020-05-02 21:29:22,234 [MainThread  ] Experiment debug
2020-05-02 21:29:22,234 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dproject_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 21:29:22,234 [MainThread  ] Start creating tasks
2020-05-02 21:29:22,234 [MainThread  ] Start loading data
2020-05-02 21:29:22,234 [MainThread  ] Loading custom_sup data
2020-05-02 21:29:22,602 [MainThread  ] Start creating models
2020-05-02 21:29:22,874 [MainThread  ] Loaded supervised model
2020-05-02 21:29:22,876 [MainThread  ] Setup trainer for custom_sup
2020-05-02 21:29:22,876 [MainThread  ] Start training custom_sup
2020-05-02 21:31:07,381 [MainThread  ] Experiment debug
2020-05-02 21:31:07,382 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dproject_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 21:31:07,382 [MainThread  ] Start creating tasks
2020-05-02 21:31:07,382 [MainThread  ] Start loading data
2020-05-02 21:31:07,382 [MainThread  ] Loading custom_sup data
2020-05-02 21:31:07,731 [MainThread  ] Start creating models
2020-05-02 21:31:16,763 [MainThread  ] Experiment debug
2020-05-02 21:31:16,763 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dproject_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 21:31:16,764 [MainThread  ] Start creating tasks
2020-05-02 21:31:16,764 [MainThread  ] Start loading data
2020-05-02 21:31:16,764 [MainThread  ] Loading custom_sup data
2020-05-02 21:31:17,122 [MainThread  ] Start creating models
2020-05-02 21:31:17,397 [MainThread  ] Loaded supervised model
2020-05-02 21:31:17,399 [MainThread  ] Setup trainer for custom_sup
2020-05-02 21:31:17,399 [MainThread  ] Start training custom_sup
2020-05-02 21:32:42,955 [MainThread  ] Experiment debug
2020-05-02 21:32:42,955 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dproject_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 21:32:42,955 [MainThread  ] Start creating tasks
2020-05-02 21:32:42,956 [MainThread  ] Start loading data
2020-05-02 21:32:42,956 [MainThread  ] Loading custom_sup data
2020-05-02 21:32:43,306 [MainThread  ] Start creating models
2020-05-02 21:32:43,568 [MainThread  ] Loaded supervised model
2020-05-02 21:32:43,570 [MainThread  ] Setup trainer for custom_sup
2020-05-02 21:32:43,570 [MainThread  ] Start training custom_sup
2020-05-02 21:32:49,416 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.7430, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7430, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2835, grad_fn=<DivBackward0>)}
2020-05-02 21:32:53,618 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.7422, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7422, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.3095, grad_fn=<DivBackward0>)}
2020-05-02 21:32:53,618 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-02 21:32:56,053 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.6896), 'recon_loss': tensor(0.6896), 'ts_road_map': tensor(0.3667)}
2020-05-02 21:32:57,138 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.6894), 'recon_loss': tensor(0.6894), 'ts_road_map': tensor(0.3677)}
2020-05-02 21:32:58,195 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.6893), 'recon_loss': tensor(0.6893), 'ts_road_map': tensor(0.3685)}
2020-05-02 21:32:59,245 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.6892), 'recon_loss': tensor(0.6892), 'ts_road_map': tensor(0.3691)}
2020-05-02 21:33:00,300 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.6892), 'recon_loss': tensor(0.6892), 'ts_road_map': tensor(0.3695)}
2020-05-02 21:33:20,063 [MainThread  ] Experiment debug
2020-05-02 21:33:20,063 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 21:33:20,063 [MainThread  ] Start creating tasks
2020-05-02 21:33:20,064 [MainThread  ] Start loading data
2020-05-02 21:33:20,064 [MainThread  ] Loading custom_sup data
2020-05-02 21:33:20,405 [MainThread  ] Start creating models
2020-05-02 21:33:21,637 [MainThread  ] Loaded supervised model
2020-05-02 21:33:21,641 [MainThread  ] Setup trainer for custom_sup
2020-05-02 21:33:21,641 [MainThread  ] Start training custom_sup
2020-05-02 21:33:32,829 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.7209, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7209, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2933, grad_fn=<DivBackward0>)}
2020-05-02 21:33:42,318 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.7205, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7205, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2991, grad_fn=<DivBackward0>)}
2020-05-02 21:33:42,318 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-02 21:33:45,153 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.6892), 'recon_loss': tensor(0.6892), 'ts_road_map': tensor(0.3685)}
2020-05-02 21:33:46,588 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.6890), 'recon_loss': tensor(0.6890), 'ts_road_map': tensor(0.3696)}
2020-05-02 21:49:51,024 [MainThread  ] Experiment debug
2020-05-02 21:49:51,026 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 21:49:51,026 [MainThread  ] Start creating tasks
2020-05-02 21:49:51,026 [MainThread  ] Start loading data
2020-05-02 21:49:51,026 [MainThread  ] Loading custom_sup data
2020-05-02 21:49:51,398 [MainThread  ] Start creating models
2020-05-02 21:49:52,704 [MainThread  ] Loaded supervised model
2020-05-02 21:49:52,706 [MainThread  ] Setup trainer for custom_sup
2020-05-02 21:49:52,706 [MainThread  ] Start training custom_sup
2020-05-02 21:50:05,885 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.7469, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7469, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2812, grad_fn=<DivBackward0>)}
2020-05-02 21:50:15,682 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.7392, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7392, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.3118, grad_fn=<DivBackward0>)}
2020-05-02 21:50:15,682 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-02 21:50:19,132 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.6951), 'recon_loss': tensor(0.6951), 'ts_road_map': tensor(0.3535)}
2020-05-02 21:50:20,758 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.6951), 'recon_loss': tensor(0.6951), 'ts_road_map': tensor(0.3544)}
2020-05-02 21:50:22,293 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.6952), 'recon_loss': tensor(0.6952), 'ts_road_map': tensor(0.3551)}
2020-05-02 21:50:23,853 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.6952), 'recon_loss': tensor(0.6952), 'ts_road_map': tensor(0.3557)}
2020-05-02 21:50:25,421 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.6953), 'recon_loss': tensor(0.6953), 'ts_road_map': tensor(0.3560)}
2020-05-02 21:50:37,755 [MainThread  ] Experiment debug
2020-05-02 21:50:37,756 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 21:50:37,756 [MainThread  ] Start creating tasks
2020-05-02 21:50:37,756 [MainThread  ] Start loading data
2020-05-02 21:50:37,756 [MainThread  ] Loading custom_sup data
2020-05-02 21:50:38,101 [MainThread  ] Start creating models
2020-05-02 21:50:39,370 [MainThread  ] Loaded supervised model
2020-05-02 21:50:39,371 [MainThread  ] Setup trainer for custom_sup
2020-05-02 21:50:39,371 [MainThread  ] Start training custom_sup
2020-05-02 21:50:50,012 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.7310, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7310, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.3372, grad_fn=<DivBackward0>)}
2020-05-02 21:50:59,092 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.7323, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7323, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.3091, grad_fn=<DivBackward0>)}
2020-05-02 21:50:59,093 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-02 21:51:02,116 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.6969), 'recon_loss': tensor(0.6969), 'ts_road_map': tensor(0.3500)}
2020-05-02 21:51:03,605 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.6970), 'recon_loss': tensor(0.6970), 'ts_road_map': tensor(0.3509)}
2020-05-02 21:51:05,098 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.6971), 'recon_loss': tensor(0.6971), 'ts_road_map': tensor(0.3516)}
2020-05-02 21:51:06,596 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.6972), 'recon_loss': tensor(0.6972), 'ts_road_map': tensor(0.3522)}
2020-05-02 21:51:08,119 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.6972), 'recon_loss': tensor(0.6972), 'ts_road_map': tensor(0.3525)}
2020-05-02 21:51:14,114 [MainThread  ] Evalutation complete
Average result {'loss': tensor(0.6972), 'recon_loss': tensor(0.6972), 'ts_road_map': tensor(0.3525)}
2020-05-02 21:51:14,116 [MainThread  ] Best validation updated: {'best_iter': 2, 'best_performance': tensor(0.6972), 'current_iter': 2}
2020-05-02 21:51:14,399 [MainThread  ] Save parameters for ./results/debug/finetune_custom_sup_best.ckpt
2020-05-02 21:51:24,171 [MainThread  ] train batch 3 / 1260 (iter 3), current average result {'loss': tensor(0.7185, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7185, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2262, grad_fn=<DivBackward0>)}
2020-05-02 21:51:33,058 [MainThread  ] train batch 4 / 1260 (iter 4), current average result {'loss': tensor(0.7167, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7167, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2524, grad_fn=<DivBackward0>)}
2020-05-02 21:51:33,058 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-02 21:51:35,646 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.6983), 'recon_loss': tensor(0.6983), 'ts_road_map': tensor(0.3475)}
2020-05-02 21:51:37,085 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.6985), 'recon_loss': tensor(0.6985), 'ts_road_map': tensor(0.3484)}
2020-05-02 21:51:55,550 [MainThread  ] Experiment debug
2020-05-02 21:51:55,550 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dproject_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 21:51:55,550 [MainThread  ] Start creating tasks
2020-05-02 21:51:55,550 [MainThread  ] Start loading data
2020-05-02 21:51:55,550 [MainThread  ] Loading custom_sup data
2020-05-02 21:51:55,917 [MainThread  ] Start creating models
2020-05-02 21:51:56,173 [MainThread  ] Loaded supervised model
2020-05-02 21:51:56,174 [MainThread  ] Setup trainer for custom_sup
2020-05-02 21:51:56,174 [MainThread  ] Start training custom_sup
2020-05-02 21:52:01,258 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.7456, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7456, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2398, grad_fn=<DivBackward0>)}
2020-05-02 21:52:05,253 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.7353, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7353, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2451, grad_fn=<DivBackward0>)}
2020-05-02 21:52:05,253 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-02 21:52:07,177 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.6927), 'recon_loss': tensor(0.6927), 'ts_road_map': tensor(0.3585)}
2020-05-02 21:52:08,189 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.6926), 'recon_loss': tensor(0.6926), 'ts_road_map': tensor(0.3595)}
2020-05-02 21:52:09,188 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.6926), 'recon_loss': tensor(0.6926), 'ts_road_map': tensor(0.3602)}
2020-05-02 21:52:10,176 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.6926), 'recon_loss': tensor(0.6926), 'ts_road_map': tensor(0.3608)}
2020-05-02 21:52:11,172 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.6926), 'recon_loss': tensor(0.6926), 'ts_road_map': tensor(0.3611)}
2020-05-02 21:52:16,843 [MainThread  ] Evalutation complete
Average result {'loss': tensor(0.6926), 'recon_loss': tensor(0.6926), 'ts_road_map': tensor(0.3611)}
2020-05-02 21:52:16,845 [MainThread  ] Best validation updated: {'best_iter': 2, 'best_performance': tensor(0.6926), 'current_iter': 2}
2020-05-02 21:52:16,935 [MainThread  ] Save parameters for ./results/debug/finetune_custom_sup_best.ckpt
2020-05-02 21:52:21,149 [MainThread  ] train batch 3 / 1260 (iter 3), current average result {'loss': tensor(0.7184, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7184, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.3207, grad_fn=<DivBackward0>)}
2020-05-02 21:52:32,424 [MainThread  ] Experiment debug
2020-05-02 21:52:32,425 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dproject_dense_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 21:52:32,425 [MainThread  ] Start creating tasks
2020-05-02 21:52:32,425 [MainThread  ] Start loading data
2020-05-02 21:52:32,425 [MainThread  ] Loading custom_sup data
2020-05-02 21:52:32,774 [MainThread  ] Start creating models
2020-05-02 21:52:33,034 [MainThread  ] Loaded supervised model
2020-05-02 21:52:33,035 [MainThread  ] Setup trainer for custom_sup
2020-05-02 21:52:33,036 [MainThread  ] Start training custom_sup
2020-05-02 21:52:37,572 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.7106, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7106, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2783, grad_fn=<DivBackward0>)}
2020-05-02 21:52:41,050 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.7115, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7115, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2730, grad_fn=<DivBackward0>)}
2020-05-02 21:52:41,050 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-02 21:52:42,779 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.7103), 'recon_loss': tensor(0.7103), 'ts_road_map': tensor(0.3301)}
2020-05-02 21:52:43,693 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.7108), 'recon_loss': tensor(0.7108), 'ts_road_map': tensor(0.3309)}
2020-05-02 21:52:44,579 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.7111), 'recon_loss': tensor(0.7111), 'ts_road_map': tensor(0.3315)}
2020-05-02 21:52:45,441 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.7114), 'recon_loss': tensor(0.7114), 'ts_road_map': tensor(0.3320)}
2020-05-02 21:52:46,335 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.7116), 'recon_loss': tensor(0.7116), 'ts_road_map': tensor(0.3323)}
2020-05-02 21:52:52,627 [MainThread  ] Evalutation complete
Average result {'loss': tensor(0.7116), 'recon_loss': tensor(0.7116), 'ts_road_map': tensor(0.3323)}
2020-05-02 21:52:52,628 [MainThread  ] Best validation updated: {'best_iter': 2, 'best_performance': tensor(0.7116), 'current_iter': 2}
2020-05-02 21:52:52,679 [MainThread  ] Save parameters for ./results/debug/finetune_custom_sup_best.ckpt
2020-05-02 21:52:56,463 [MainThread  ] train batch 3 / 1260 (iter 3), current average result {'loss': tensor(0.7023, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7023, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2720, grad_fn=<DivBackward0>)}
2020-05-02 21:53:00,340 [MainThread  ] train batch 4 / 1260 (iter 4), current average result {'loss': tensor(0.7061, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7061, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2708, grad_fn=<DivBackward0>)}
2020-05-02 21:53:00,341 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-02 21:53:02,427 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.7138), 'recon_loss': tensor(0.7138), 'ts_road_map': tensor(0.3257)}
2020-05-02 21:53:03,362 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.7144), 'recon_loss': tensor(0.7144), 'ts_road_map': tensor(0.3265)}
2020-05-02 21:53:04,304 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.7149), 'recon_loss': tensor(0.7149), 'ts_road_map': tensor(0.3272)}
2020-05-02 21:53:05,236 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.7152), 'recon_loss': tensor(0.7152), 'ts_road_map': tensor(0.3276)}
2020-05-02 21:53:06,115 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.7154), 'recon_loss': tensor(0.7154), 'ts_road_map': tensor(0.3279)}
2020-05-02 21:53:11,722 [MainThread  ] Evalutation complete
Average result {'loss': tensor(0.7154), 'recon_loss': tensor(0.7154), 'ts_road_map': tensor(0.3279)}
2020-05-02 21:54:23,179 [MainThread  ] Experiment debug
2020-05-02 21:54:23,179 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 21:54:23,179 [MainThread  ] Start creating tasks
2020-05-02 21:54:23,179 [MainThread  ] Start loading data
2020-05-02 21:54:23,179 [MainThread  ] Loading custom_sup data
2020-05-02 21:54:23,545 [MainThread  ] Start creating models
2020-05-02 21:54:24,786 [MainThread  ] Loaded supervised model
2020-05-02 21:54:24,789 [MainThread  ] Setup trainer for custom_sup
2020-05-02 21:54:24,789 [MainThread  ] Start training custom_sup
2020-05-02 21:54:35,347 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.7408, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7408, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2773, grad_fn=<DivBackward0>)}
2020-05-02 21:55:20,252 [MainThread  ] Experiment debug
2020-05-02 21:55:20,252 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dproject_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-02 21:55:20,252 [MainThread  ] Start creating tasks
2020-05-02 21:55:20,252 [MainThread  ] Start loading data
2020-05-02 21:55:20,252 [MainThread  ] Loading custom_sup data
2020-05-02 21:55:20,610 [MainThread  ] Start creating models
2020-05-02 21:55:20,867 [MainThread  ] Loaded supervised model
2020-05-02 21:55:20,868 [MainThread  ] Setup trainer for custom_sup
2020-05-02 21:55:20,868 [MainThread  ] Start training custom_sup
2020-05-02 21:55:26,358 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.7639, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7639, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.3262, grad_fn=<DivBackward0>)}
2020-05-02 21:55:30,699 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.7645, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7645, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.3178, grad_fn=<DivBackward0>)}
2020-05-02 21:55:30,700 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-02 21:55:32,875 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.6926), 'recon_loss': tensor(0.6926), 'ts_road_map': tensor(0.3587)}
2020-05-02 21:55:33,878 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.6926), 'recon_loss': tensor(0.6926), 'ts_road_map': tensor(0.3597)}
2020-05-02 21:55:34,895 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.6926), 'recon_loss': tensor(0.6926), 'ts_road_map': tensor(0.3604)}
2020-05-02 21:55:35,908 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.6926), 'recon_loss': tensor(0.6926), 'ts_road_map': tensor(0.3610)}
2020-05-02 21:55:36,914 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.6926), 'recon_loss': tensor(0.6926), 'ts_road_map': tensor(0.3613)}
2020-05-02 21:55:42,388 [MainThread  ] Evalutation complete
Average result {'loss': tensor(0.6926), 'recon_loss': tensor(0.6926), 'ts_road_map': tensor(0.3613)}
2020-05-02 21:55:42,390 [MainThread  ] Best validation updated: {'best_iter': 2, 'best_performance': tensor(0.6926), 'current_iter': 2}
2020-05-02 21:55:42,444 [MainThread  ] Save parameters for ./results/debug/finetune_custom_sup_best.ckpt
2020-05-02 21:55:46,572 [MainThread  ] train batch 3 / 1260 (iter 3), current average result {'loss': tensor(0.7531, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7531, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.3044, grad_fn=<DivBackward0>)}
2020-05-02 21:55:50,522 [MainThread  ] train batch 4 / 1260 (iter 4), current average result {'loss': tensor(0.7432, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7432, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.3251, grad_fn=<DivBackward0>)}
2020-05-02 21:55:50,523 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-02 21:55:52,410 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.6926), 'recon_loss': tensor(0.6926), 'ts_road_map': tensor(0.3588)}
2020-05-03 11:40:46,674 [MainThread  ] Experiment debug
2020-05-03 11:40:46,674 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 11:40:46,675 [MainThread  ] Start creating tasks
2020-05-03 11:40:46,675 [MainThread  ] Start loading data
2020-05-03 11:40:46,675 [MainThread  ] Loading custom_sup data
2020-05-03 11:40:47,061 [MainThread  ] Start creating models
2020-05-03 11:40:47,403 [MainThread  ] Loaded supervised model
2020-05-03 11:40:47,406 [MainThread  ] Setup trainer for custom_sup
2020-05-03 11:40:47,406 [MainThread  ] Start training custom_sup
2020-05-03 11:40:54,793 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.0833, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0833, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:41:53,913 [MainThread  ] Experiment debug
2020-05-03 11:41:53,914 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 11:41:53,914 [MainThread  ] Start creating tasks
2020-05-03 11:41:53,914 [MainThread  ] Start loading data
2020-05-03 11:41:53,914 [MainThread  ] Loading custom_sup data
2020-05-03 11:41:54,274 [MainThread  ] Start creating models
2020-05-03 11:41:54,595 [MainThread  ] Loaded supervised model
2020-05-03 11:41:54,597 [MainThread  ] Setup trainer for custom_sup
2020-05-03 11:41:54,597 [MainThread  ] Start training custom_sup
2020-05-03 11:42:01,501 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.0833, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0833, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:44:05,628 [MainThread  ] Experiment debug
2020-05-03 11:44:05,629 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 11:44:05,629 [MainThread  ] Start creating tasks
2020-05-03 11:44:05,629 [MainThread  ] Start loading data
2020-05-03 11:44:05,629 [MainThread  ] Loading custom_sup data
2020-05-03 11:44:06,024 [MainThread  ] Start creating models
2020-05-03 11:44:06,409 [MainThread  ] Loaded supervised model
2020-05-03 11:44:06,411 [MainThread  ] Setup trainer for custom_sup
2020-05-03 11:44:06,412 [MainThread  ] Start training custom_sup
2020-05-03 11:44:13,630 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.0833, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0833, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:44:19,028 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.0833, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0833, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:44:19,028 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-03 11:44:22,292 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:44:24,636 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:44:26,767 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:44:28,841 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:44:31,063 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:44:37,949 [MainThread  ] Evalutation complete
Average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:44:37,952 [MainThread  ] Best validation updated: {'best_iter': 2, 'best_performance': tensor(0.0833), 'current_iter': 2}
2020-05-03 11:44:38,032 [MainThread  ] Save parameters for ./results/debug/finetune_custom_sup_best.ckpt
2020-05-03 11:45:37,312 [MainThread  ] Experiment debug
2020-05-03 11:45:37,312 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 11:45:37,312 [MainThread  ] Start creating tasks
2020-05-03 11:45:37,312 [MainThread  ] Start loading data
2020-05-03 11:45:37,312 [MainThread  ] Loading custom_sup data
2020-05-03 11:45:37,677 [MainThread  ] Start creating models
2020-05-03 11:45:38,003 [MainThread  ] Loaded supervised model
2020-05-03 11:45:38,005 [MainThread  ] Setup trainer for custom_sup
2020-05-03 11:45:38,005 [MainThread  ] Start training custom_sup
2020-05-03 11:45:45,187 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.0833, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0833, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:45:50,894 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.0833, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0833, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:45:50,894 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-03 11:45:53,914 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:45:55,950 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:45:58,032 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:46:00,162 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:46:02,316 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:46:31,771 [MainThread  ] Experiment debug
2020-05-03 11:46:31,771 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 11:46:31,771 [MainThread  ] Start creating tasks
2020-05-03 11:46:31,771 [MainThread  ] Start loading data
2020-05-03 11:46:31,771 [MainThread  ] Loading custom_sup data
2020-05-03 11:46:32,151 [MainThread  ] Start creating models
2020-05-03 11:46:32,482 [MainThread  ] Loaded supervised model
2020-05-03 11:46:32,484 [MainThread  ] Setup trainer for custom_sup
2020-05-03 11:46:32,484 [MainThread  ] Start training custom_sup
2020-05-03 11:46:37,440 [MainThread  ] Experiment debug
2020-05-03 11:46:37,440 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 11:46:37,440 [MainThread  ] Start creating tasks
2020-05-03 11:46:37,441 [MainThread  ] Start loading data
2020-05-03 11:46:37,441 [MainThread  ] Loading custom_sup data
2020-05-03 11:46:37,803 [MainThread  ] Start creating models
2020-05-03 11:46:38,189 [MainThread  ] Loaded supervised model
2020-05-03 11:46:38,193 [MainThread  ] Setup trainer for custom_sup
2020-05-03 11:46:38,193 [MainThread  ] Start training custom_sup
2020-05-03 11:46:45,507 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(1.0312, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.6266, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.4046, grad_fn=<DivBackward0>), 'ts_boxes': tensor(0.)}
2020-05-03 11:46:51,282 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.5572, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.3549, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.2023, grad_fn=<DivBackward0>), 'ts_boxes': tensor(0.)}
2020-05-03 11:46:51,283 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-03 11:46:54,300 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:46:56,356 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:47:31,710 [MainThread  ] Experiment debug
2020-05-03 11:47:31,710 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 11:47:31,710 [MainThread  ] Start creating tasks
2020-05-03 11:47:31,710 [MainThread  ] Start loading data
2020-05-03 11:47:31,710 [MainThread  ] Loading custom_sup data
2020-05-03 11:47:32,085 [MainThread  ] Start creating models
2020-05-03 11:47:32,419 [MainThread  ] Loaded supervised model
2020-05-03 11:47:32,421 [MainThread  ] Setup trainer for custom_sup
2020-05-03 11:47:32,422 [MainThread  ] Start training custom_sup
2020-05-03 11:47:39,767 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.0833, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0833, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:47:45,843 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.0833, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0833, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:47:45,844 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-03 11:47:48,978 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:47:51,296 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:47:53,417 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:47:55,662 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:47:57,867 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:48:04,606 [MainThread  ] Evalutation complete
Average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:48:04,608 [MainThread  ] Best validation updated: {'best_iter': 2, 'best_performance': tensor(0.0833), 'current_iter': 2}
2020-05-03 11:48:04,678 [MainThread  ] Save parameters for ./results/debug/finetune_custom_sup_best.ckpt
2020-05-03 11:48:10,739 [MainThread  ] train batch 3 / 1260 (iter 3), current average result {'loss': tensor(0.0833, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0833, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:48:24,058 [MainThread  ] Experiment debug
2020-05-03 11:48:24,058 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_project=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 11:48:24,059 [MainThread  ] Start creating tasks
2020-05-03 11:48:24,059 [MainThread  ] Start loading data
2020-05-03 11:48:24,059 [MainThread  ] Loading custom_sup data
2020-05-03 11:48:24,430 [MainThread  ] Start creating models
2020-05-03 11:48:24,751 [MainThread  ] Loaded supervised model
2020-05-03 11:48:24,753 [MainThread  ] Setup trainer for custom_sup
2020-05-03 11:48:24,753 [MainThread  ] Start training custom_sup
2020-05-03 11:48:31,819 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.0833, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0833, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:48:38,022 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.0833, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0833, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:48:38,023 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-03 11:48:42,059 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:48:44,132 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:48:46,277 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:48:48,611 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:48:50,848 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:48:56,513 [MainThread  ] Evalutation complete
Average result {'loss': tensor(0.0833), 'classification_loss': tensor(0.0833), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:48:56,514 [MainThread  ] Best validation updated: {'best_iter': 2, 'best_performance': tensor(0.0833), 'current_iter': 2}
2020-05-03 11:48:56,580 [MainThread  ] Save parameters for ./results/debug/finetune_custom_sup_best.ckpt
2020-05-03 11:49:02,765 [MainThread  ] train batch 3 / 1260 (iter 3), current average result {'loss': tensor(0.0833, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0833, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:49:09,107 [MainThread  ] train batch 4 / 1260 (iter 4), current average result {'loss': tensor(0.0832, grad_fn=<DivBackward0>), 'classification_loss': tensor(0.0832, grad_fn=<DivBackward0>), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:49:09,107 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-03 11:49:12,356 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.0832), 'classification_loss': tensor(0.0832), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 11:49:14,473 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.0832), 'classification_loss': tensor(0.0832), 'detection_loss': tensor(0.), 'ts_boxes': tensor(0.)}
2020-05-03 14:50:46,512 [MainThread  ] Experiment debug
2020-05-03 14:50:46,513 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=0, dense_before_fuse=0, detect_objects=True, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=False, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 14:50:46,513 [MainThread  ] Start creating tasks
2020-05-03 14:50:46,513 [MainThread  ] Start loading data
2020-05-03 14:50:46,513 [MainThread  ] Loading custom_sup data
2020-05-03 14:50:46,859 [MainThread  ] Start creating models
2020-05-03 14:50:47,180 [MainThread  ] Loaded supervised model
2020-05-03 14:50:47,182 [MainThread  ] Setup trainer for custom_sup
2020-05-03 14:50:47,182 [MainThread  ] Start training custom_sup
2020-05-03 14:51:06,409 [MainThread  ] Experiment debug
2020-05-03 14:51:06,409 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=0, dense_before_fuse=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 14:51:06,410 [MainThread  ] Start creating tasks
2020-05-03 14:51:06,410 [MainThread  ] Start loading data
2020-05-03 14:51:06,410 [MainThread  ] Loading custom_sup data
2020-05-03 14:51:06,756 [MainThread  ] Start creating models
2020-05-03 14:51:28,900 [MainThread  ] Experiment debug
2020-05-03 14:51:28,900 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=0, dense_before_fuse=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 14:51:28,900 [MainThread  ] Start creating tasks
2020-05-03 14:51:28,901 [MainThread  ] Start loading data
2020-05-03 14:51:28,901 [MainThread  ] Loading custom_sup data
2020-05-03 14:51:29,254 [MainThread  ] Start creating models
2020-05-03 14:51:30,565 [MainThread  ] Loaded supervised model
2020-05-03 14:51:30,567 [MainThread  ] Setup trainer for custom_sup
2020-05-03 14:51:30,567 [MainThread  ] Start training custom_sup
2020-05-03 14:51:53,569 [MainThread  ] Experiment debug
2020-05-03 14:51:53,569 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=0, dense_before_fuse=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 14:51:53,569 [MainThread  ] Start creating tasks
2020-05-03 14:51:53,569 [MainThread  ] Start loading data
2020-05-03 14:51:53,569 [MainThread  ] Loading custom_sup data
2020-05-03 14:51:53,925 [MainThread  ] Start creating models
2020-05-03 14:51:55,233 [MainThread  ] Loaded supervised model
2020-05-03 14:51:55,235 [MainThread  ] Setup trainer for custom_sup
2020-05-03 14:51:55,235 [MainThread  ] Start training custom_sup
2020-05-03 14:52:07,724 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.7443, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7443, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2481, grad_fn=<DivBackward0>)}
2020-05-03 14:52:18,397 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.7487, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7487, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2813, grad_fn=<DivBackward0>)}
2020-05-03 14:52:18,398 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-03 14:52:21,103 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.6955), 'recon_loss': tensor(0.6955), 'ts_road_map': tensor(0.3523)}
2020-05-03 14:52:22,608 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.6956), 'recon_loss': tensor(0.6956), 'ts_road_map': tensor(0.3532)}
2020-05-03 14:52:24,068 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.6957), 'recon_loss': tensor(0.6957), 'ts_road_map': tensor(0.3539)}
2020-05-03 14:52:25,528 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.6958), 'recon_loss': tensor(0.6958), 'ts_road_map': tensor(0.3545)}
2020-05-03 14:52:26,987 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.6958), 'recon_loss': tensor(0.6958), 'ts_road_map': tensor(0.3548)}
2020-05-03 14:52:33,028 [MainThread  ] Evalutation complete
Average result {'loss': tensor(0.6958), 'recon_loss': tensor(0.6958), 'ts_road_map': tensor(0.3548)}
2020-05-03 14:52:33,029 [MainThread  ] Best validation updated: {'best_iter': 2, 'best_performance': tensor(0.6958), 'current_iter': 2}
2020-05-03 14:52:33,293 [MainThread  ] Save parameters for ./results/debug/finetune_custom_sup_best.ckpt
2020-05-03 14:52:43,519 [MainThread  ] train batch 3 / 1260 (iter 3), current average result {'loss': tensor(0.7459, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7459, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2928, grad_fn=<DivBackward0>)}
2020-05-03 15:15:40,471 [MainThread  ] Experiment debug
2020-05-03 15:15:40,472 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=0, dense_before_fuse=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:15:40,473 [MainThread  ] Start creating tasks
2020-05-03 15:15:40,473 [MainThread  ] Start loading data
2020-05-03 15:15:40,473 [MainThread  ] Loading custom_sup data
2020-05-03 15:15:40,867 [MainThread  ] Start creating models
2020-05-03 15:16:07,162 [MainThread  ] Experiment debug
2020-05-03 15:16:07,162 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=0, dense_before_fuse=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:16:07,162 [MainThread  ] Start creating tasks
2020-05-03 15:16:07,162 [MainThread  ] Start loading data
2020-05-03 15:16:07,162 [MainThread  ] Loading custom_sup data
2020-05-03 15:16:07,527 [MainThread  ] Start creating models
2020-05-03 15:16:08,846 [MainThread  ] Loaded supervised model
2020-05-03 15:16:08,848 [MainThread  ] Setup trainer for custom_sup
2020-05-03 15:16:08,848 [MainThread  ] Start training custom_sup
2020-05-03 15:16:22,046 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.7656, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7656, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2933, grad_fn=<DivBackward0>)}
2020-05-03 15:16:31,484 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.7531, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7531, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2937, grad_fn=<DivBackward0>)}
2020-05-03 15:16:31,484 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-03 15:16:35,120 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.6965), 'recon_loss': tensor(0.6965), 'ts_road_map': tensor(0.3506)}
2020-05-03 15:16:36,552 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.6966), 'recon_loss': tensor(0.6966), 'ts_road_map': tensor(0.3515)}
2020-05-03 15:16:37,997 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.6967), 'recon_loss': tensor(0.6967), 'ts_road_map': tensor(0.3522)}
2020-05-03 15:16:39,442 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.6968), 'recon_loss': tensor(0.6968), 'ts_road_map': tensor(0.3527)}
2020-05-03 15:16:40,862 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.6969), 'recon_loss': tensor(0.6969), 'ts_road_map': tensor(0.3531)}
2020-05-03 15:16:47,021 [MainThread  ] Evalutation complete
Average result {'loss': tensor(0.6969), 'recon_loss': tensor(0.6969), 'ts_road_map': tensor(0.3531)}
2020-05-03 15:16:47,023 [MainThread  ] Best validation updated: {'best_iter': 2, 'best_performance': tensor(0.6969), 'current_iter': 2}
2020-05-03 15:16:47,299 [MainThread  ] Save parameters for ./results/debug/finetune_custom_sup_best.ckpt
2020-05-03 15:16:56,882 [MainThread  ] train batch 3 / 1260 (iter 3), current average result {'loss': tensor(0.7499, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7499, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2379, grad_fn=<DivBackward0>)}
2020-05-03 15:17:07,316 [MainThread  ] Experiment debug
2020-05-03 15:17:07,316 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=1, dense_before_fuse=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='daf_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:17:07,316 [MainThread  ] Start creating tasks
2020-05-03 15:17:07,316 [MainThread  ] Start loading data
2020-05-03 15:17:07,317 [MainThread  ] Loading custom_sup data
2020-05-03 15:17:07,655 [MainThread  ] Start creating models
2020-05-03 15:17:35,869 [MainThread  ] Experiment debug
2020-05-03 15:17:35,869 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=1, dense_before_fuse=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='daf_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:17:35,869 [MainThread  ] Start creating tasks
2020-05-03 15:17:35,869 [MainThread  ] Start loading data
2020-05-03 15:17:35,869 [MainThread  ] Loading custom_sup data
2020-05-03 15:17:36,205 [MainThread  ] Start creating models
2020-05-03 15:17:37,496 [MainThread  ] Loaded supervised model
2020-05-03 15:17:37,498 [MainThread  ] Setup trainer for custom_sup
2020-05-03 15:17:37,498 [MainThread  ] Start training custom_sup
2020-05-03 15:18:32,674 [MainThread  ] Experiment debug
2020-05-03 15:18:32,675 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=1, dense_before_fuse=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='daf_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:18:32,675 [MainThread  ] Start creating tasks
2020-05-03 15:18:32,675 [MainThread  ] Start loading data
2020-05-03 15:18:32,675 [MainThread  ] Loading custom_sup data
2020-05-03 15:18:33,010 [MainThread  ] Start creating models
2020-05-03 15:18:34,267 [MainThread  ] Loaded supervised model
2020-05-03 15:18:34,269 [MainThread  ] Setup trainer for custom_sup
2020-05-03 15:18:34,269 [MainThread  ] Start training custom_sup
2020-05-03 15:18:45,432 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.7299, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7299, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2960, grad_fn=<DivBackward0>)}
2020-05-03 15:18:55,514 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.7290, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7290, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2848, grad_fn=<DivBackward0>)}
2020-05-03 15:18:55,515 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-03 15:18:58,671 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.6942), 'recon_loss': tensor(0.6942), 'ts_road_map': tensor(0.3550)}
2020-05-03 15:19:00,164 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.6943), 'recon_loss': tensor(0.6943), 'ts_road_map': tensor(0.3560)}
2020-05-03 15:19:01,597 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.6943), 'recon_loss': tensor(0.6943), 'ts_road_map': tensor(0.3567)}
2020-05-03 15:19:03,024 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.6943), 'recon_loss': tensor(0.6943), 'ts_road_map': tensor(0.3572)}
2020-05-03 15:19:04,462 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.6943), 'recon_loss': tensor(0.6943), 'ts_road_map': tensor(0.3576)}
2020-05-03 15:19:10,695 [MainThread  ] Evalutation complete
Average result {'loss': tensor(0.6943), 'recon_loss': tensor(0.6943), 'ts_road_map': tensor(0.3576)}
2020-05-03 15:19:10,697 [MainThread  ] Best validation updated: {'best_iter': 2, 'best_performance': tensor(0.6943), 'current_iter': 2}
2020-05-03 15:19:10,963 [MainThread  ] Save parameters for ./results/debug/finetune_custom_sup_best.ckpt
2020-05-03 15:19:21,461 [MainThread  ] train batch 3 / 1260 (iter 3), current average result {'loss': tensor(0.7263, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7263, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.3226, grad_fn=<DivBackward0>)}
2020-05-03 15:19:30,534 [MainThread  ] train batch 4 / 1260 (iter 4), current average result {'loss': tensor(0.7295, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7295, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.3059, grad_fn=<DivBackward0>)}
2020-05-03 15:19:30,534 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-03 15:19:33,120 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.6948), 'recon_loss': tensor(0.6948), 'ts_road_map': tensor(0.3538)}
2020-05-03 15:19:45,373 [MainThread  ] Experiment debug
2020-05-03 15:19:45,374 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=1, dense_before_fuse=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dbf_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:19:45,374 [MainThread  ] Start creating tasks
2020-05-03 15:19:45,374 [MainThread  ] Start loading data
2020-05-03 15:19:45,374 [MainThread  ] Loading custom_sup data
2020-05-03 15:19:45,704 [MainThread  ] Start creating models
2020-05-03 15:20:05,350 [MainThread  ] Experiment debug
2020-05-03 15:20:05,350 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=1, dense_before_fuse=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dbf_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:20:05,350 [MainThread  ] Start creating tasks
2020-05-03 15:20:05,350 [MainThread  ] Start loading data
2020-05-03 15:20:05,351 [MainThread  ] Loading custom_sup data
2020-05-03 15:20:05,708 [MainThread  ] Start creating models
2020-05-03 15:20:05,888 [MainThread  ] Loaded supervised model
2020-05-03 15:20:05,889 [MainThread  ] Setup trainer for custom_sup
2020-05-03 15:20:05,889 [MainThread  ] Start training custom_sup
2020-05-03 15:21:30,705 [MainThread  ] Experiment debug
2020-05-03 15:21:30,705 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=0, dense_before_fuse=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dbf_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:21:30,706 [MainThread  ] Start creating tasks
2020-05-03 15:21:30,706 [MainThread  ] Start loading data
2020-05-03 15:21:30,706 [MainThread  ] Loading custom_sup data
2020-05-03 15:21:31,042 [MainThread  ] Start creating models
2020-05-03 15:21:31,221 [MainThread  ] Loaded supervised model
2020-05-03 15:21:31,223 [MainThread  ] Setup trainer for custom_sup
2020-05-03 15:21:31,223 [MainThread  ] Start training custom_sup
2020-05-03 15:21:41,894 [MainThread  ] Experiment debug
2020-05-03 15:21:41,894 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=0, dense_before_fuse=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dbf_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:21:41,895 [MainThread  ] Start creating tasks
2020-05-03 15:21:41,895 [MainThread  ] Start loading data
2020-05-03 15:21:41,895 [MainThread  ] Loading custom_sup data
2020-05-03 15:21:42,233 [MainThread  ] Start creating models
2020-05-03 15:21:42,418 [MainThread  ] Loaded supervised model
2020-05-03 15:21:42,420 [MainThread  ] Setup trainer for custom_sup
2020-05-03 15:21:42,420 [MainThread  ] Start training custom_sup
2020-05-03 15:23:04,611 [MainThread  ] Experiment debug
2020-05-03 15:23:04,612 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=0, dense_before_fuse=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dbf_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:23:04,612 [MainThread  ] Start creating tasks
2020-05-03 15:23:04,612 [MainThread  ] Start loading data
2020-05-03 15:23:04,612 [MainThread  ] Loading custom_sup data
2020-05-03 15:23:04,969 [MainThread  ] Start creating models
2020-05-03 15:23:05,155 [MainThread  ] Loaded supervised model
2020-05-03 15:23:05,157 [MainThread  ] Setup trainer for custom_sup
2020-05-03 15:23:05,157 [MainThread  ] Start training custom_sup
2020-05-03 15:23:39,852 [MainThread  ] Experiment debug
2020-05-03 15:23:39,852 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=0, dense_before_fuse=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dbf_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:23:39,853 [MainThread  ] Start creating tasks
2020-05-03 15:23:39,853 [MainThread  ] Start loading data
2020-05-03 15:23:39,853 [MainThread  ] Loading custom_sup data
2020-05-03 15:23:40,198 [MainThread  ] Start creating models
2020-05-03 15:23:40,380 [MainThread  ] Loaded supervised model
2020-05-03 15:23:40,382 [MainThread  ] Setup trainer for custom_sup
2020-05-03 15:23:40,382 [MainThread  ] Start training custom_sup
2020-05-03 15:24:16,875 [MainThread  ] Experiment debug
2020-05-03 15:24:16,876 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=0, dense_before_fuse=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dbf_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:24:16,876 [MainThread  ] Start creating tasks
2020-05-03 15:24:16,876 [MainThread  ] Start loading data
2020-05-03 15:24:16,876 [MainThread  ] Loading custom_sup data
2020-05-03 15:24:17,225 [MainThread  ] Start creating models
2020-05-03 15:24:17,410 [MainThread  ] Loaded supervised model
2020-05-03 15:24:17,412 [MainThread  ] Setup trainer for custom_sup
2020-05-03 15:24:17,412 [MainThread  ] Start training custom_sup
2020-05-03 15:24:31,273 [MainThread  ] Experiment debug
2020-05-03 15:24:31,273 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=0, dense_before_fuse=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dbf_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:24:31,273 [MainThread  ] Start creating tasks
2020-05-03 15:24:31,273 [MainThread  ] Start loading data
2020-05-03 15:24:31,273 [MainThread  ] Loading custom_sup data
2020-05-03 15:24:31,631 [MainThread  ] Start creating models
2020-05-03 15:24:31,820 [MainThread  ] Loaded supervised model
2020-05-03 15:24:31,822 [MainThread  ] Setup trainer for custom_sup
2020-05-03 15:24:31,823 [MainThread  ] Start training custom_sup
2020-05-03 15:25:16,054 [MainThread  ] Experiment debug
2020-05-03 15:25:16,055 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=0, dense_before_fuse=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dbf_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:25:16,055 [MainThread  ] Start creating tasks
2020-05-03 15:25:16,055 [MainThread  ] Start loading data
2020-05-03 15:25:16,055 [MainThread  ] Loading custom_sup data
2020-05-03 15:25:16,413 [MainThread  ] Start creating models
2020-05-03 15:25:16,595 [MainThread  ] Loaded supervised model
2020-05-03 15:25:16,596 [MainThread  ] Setup trainer for custom_sup
2020-05-03 15:25:16,596 [MainThread  ] Start training custom_sup
2020-05-03 15:25:46,906 [MainThread  ] Experiment debug
2020-05-03 15:25:46,906 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=0, dense_before_fuse=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dbf_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:25:46,906 [MainThread  ] Start creating tasks
2020-05-03 15:25:46,906 [MainThread  ] Start loading data
2020-05-03 15:25:46,906 [MainThread  ] Loading custom_sup data
2020-05-03 15:25:47,255 [MainThread  ] Start creating models
2020-05-03 15:25:47,443 [MainThread  ] Loaded supervised model
2020-05-03 15:25:47,446 [MainThread  ] Setup trainer for custom_sup
2020-05-03 15:25:47,446 [MainThread  ] Start training custom_sup
2020-05-03 15:28:09,951 [MainThread  ] Experiment debug
2020-05-03 15:28:09,952 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=0, dense_before_fuse=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dbf_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:28:09,952 [MainThread  ] Start creating tasks
2020-05-03 15:28:09,952 [MainThread  ] Start loading data
2020-05-03 15:28:09,952 [MainThread  ] Loading custom_sup data
2020-05-03 15:28:10,327 [MainThread  ] Start creating models
2020-05-03 15:28:10,534 [MainThread  ] Loaded supervised model
2020-05-03 15:28:10,536 [MainThread  ] Setup trainer for custom_sup
2020-05-03 15:28:10,536 [MainThread  ] Start training custom_sup
2020-05-03 15:29:01,833 [MainThread  ] Experiment debug
2020-05-03 15:29:01,833 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=0, dense_before_fuse=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dbf_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:29:01,834 [MainThread  ] Start creating tasks
2020-05-03 15:29:01,834 [MainThread  ] Start loading data
2020-05-03 15:29:01,834 [MainThread  ] Loading custom_sup data
2020-05-03 15:29:02,183 [MainThread  ] Start creating models
2020-05-03 15:29:02,387 [MainThread  ] Loaded supervised model
2020-05-03 15:29:02,389 [MainThread  ] Setup trainer for custom_sup
2020-05-03 15:29:02,389 [MainThread  ] Start training custom_sup
2020-05-03 15:31:00,825 [MainThread  ] Experiment debug
2020-05-03 15:31:00,825 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=0, dense_before_fuse=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dbf_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:31:00,826 [MainThread  ] Start creating tasks
2020-05-03 15:31:00,826 [MainThread  ] Start loading data
2020-05-03 15:31:00,826 [MainThread  ] Loading custom_sup data
2020-05-03 15:31:01,171 [MainThread  ] Start creating models
2020-05-03 15:31:01,379 [MainThread  ] Loaded supervised model
2020-05-03 15:31:01,382 [MainThread  ] Setup trainer for custom_sup
2020-05-03 15:31:01,382 [MainThread  ] Start training custom_sup
2020-05-03 15:33:30,011 [MainThread  ] Experiment debug
2020-05-03 15:33:30,011 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=0, dense_before_fuse=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dbf_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:33:30,012 [MainThread  ] Start creating tasks
2020-05-03 15:33:30,012 [MainThread  ] Start loading data
2020-05-03 15:33:30,013 [MainThread  ] Loading custom_sup data
2020-05-03 15:33:30,364 [MainThread  ] Start creating models
2020-05-03 15:33:30,551 [MainThread  ] Loaded supervised model
2020-05-03 15:33:30,553 [MainThread  ] Setup trainer for custom_sup
2020-05-03 15:33:30,553 [MainThread  ] Start training custom_sup
2020-05-03 15:35:45,513 [MainThread  ] Experiment debug
2020-05-03 15:35:45,513 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=0, dense_before_fuse=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dbf_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:35:45,513 [MainThread  ] Start creating tasks
2020-05-03 15:35:45,513 [MainThread  ] Start loading data
2020-05-03 15:35:45,513 [MainThread  ] Loading custom_sup data
2020-05-03 15:35:45,854 [MainThread  ] Start creating models
2020-05-03 15:35:46,059 [MainThread  ] Loaded supervised model
2020-05-03 15:35:46,060 [MainThread  ] Setup trainer for custom_sup
2020-05-03 15:35:46,061 [MainThread  ] Start training custom_sup
2020-05-03 15:36:18,384 [MainThread  ] Experiment debug
2020-05-03 15:36:18,385 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=0, dense_before_fuse=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dbf_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:36:18,385 [MainThread  ] Start creating tasks
2020-05-03 15:36:18,385 [MainThread  ] Start loading data
2020-05-03 15:36:18,385 [MainThread  ] Loading custom_sup data
2020-05-03 15:36:18,755 [MainThread  ] Start creating models
2020-05-03 15:36:18,971 [MainThread  ] Loaded supervised model
2020-05-03 15:36:18,973 [MainThread  ] Setup trainer for custom_sup
2020-05-03 15:36:18,973 [MainThread  ] Start training custom_sup
2020-05-03 15:36:24,566 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.7337, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7337, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2129, grad_fn=<DivBackward0>)}
2020-05-03 15:36:28,344 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.7398, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7398, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2301, grad_fn=<DivBackward0>)}
2020-05-03 15:36:28,345 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-03 15:36:49,349 [MainThread  ] Experiment debug
2020-05-03 15:36:49,349 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=0, dense_before_fuse=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dbf_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:36:49,350 [MainThread  ] Start creating tasks
2020-05-03 15:36:49,350 [MainThread  ] Start loading data
2020-05-03 15:36:49,350 [MainThread  ] Loading custom_sup data
2020-05-03 15:36:49,688 [MainThread  ] Start creating models
2020-05-03 15:36:49,891 [MainThread  ] Loaded supervised model
2020-05-03 15:36:49,893 [MainThread  ] Setup trainer for custom_sup
2020-05-03 15:36:49,893 [MainThread  ] Start training custom_sup
2020-05-03 15:36:54,930 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.7209, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7209, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.3234, grad_fn=<DivBackward0>)}
2020-05-03 15:36:58,694 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.7195, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7195, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.3017, grad_fn=<DivBackward0>)}
2020-05-03 15:36:58,694 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-03 15:37:04,408 [MainThread  ] Experiment debug
2020-05-03 15:37:04,409 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=1, dense_before_fuse=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dbf_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:37:04,409 [MainThread  ] Start creating tasks
2020-05-03 15:37:04,409 [MainThread  ] Start loading data
2020-05-03 15:37:04,409 [MainThread  ] Loading custom_sup data
2020-05-03 15:37:04,740 [MainThread  ] Start creating models
2020-05-03 15:37:04,943 [MainThread  ] Loaded supervised model
2020-05-03 15:37:04,945 [MainThread  ] Setup trainer for custom_sup
2020-05-03 15:37:04,945 [MainThread  ] Start training custom_sup
2020-05-03 15:37:09,739 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.7218, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7218, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.3310, grad_fn=<DivBackward0>)}
2020-05-03 15:37:13,391 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.7359, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7359, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2887, grad_fn=<DivBackward0>)}
2020-05-03 15:37:13,391 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-03 15:37:20,850 [MainThread  ] Experiment debug
2020-05-03 15:37:20,850 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=0, dense_before_fuse=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dbf_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:37:20,850 [MainThread  ] Start creating tasks
2020-05-03 15:37:20,850 [MainThread  ] Start loading data
2020-05-03 15:37:20,850 [MainThread  ] Loading custom_sup data
2020-05-03 15:37:21,187 [MainThread  ] Start creating models
2020-05-03 15:37:21,398 [MainThread  ] Loaded supervised model
2020-05-03 15:37:21,400 [MainThread  ] Setup trainer for custom_sup
2020-05-03 15:37:21,400 [MainThread  ] Start training custom_sup
2020-05-03 15:37:26,166 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.7111, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7111, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2126, grad_fn=<DivBackward0>)}
2020-05-03 15:37:29,805 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.7142, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7142, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2456, grad_fn=<DivBackward0>)}
2020-05-03 15:37:29,805 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-03 15:37:31,808 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.7001), 'recon_loss': tensor(0.7001), 'ts_road_map': tensor(0.3442)}
2020-05-03 15:37:32,753 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.7004), 'recon_loss': tensor(0.7004), 'ts_road_map': tensor(0.3451)}
2020-05-03 15:37:33,684 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.7006), 'recon_loss': tensor(0.7006), 'ts_road_map': tensor(0.3458)}
2020-05-03 15:37:34,614 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.7007), 'recon_loss': tensor(0.7007), 'ts_road_map': tensor(0.3463)}
2020-05-03 15:37:35,532 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.7008), 'recon_loss': tensor(0.7008), 'ts_road_map': tensor(0.3467)}
2020-05-03 15:37:41,233 [MainThread  ] Evalutation complete
Average result {'loss': tensor(0.7008), 'recon_loss': tensor(0.7008), 'ts_road_map': tensor(0.3467)}
2020-05-03 15:37:41,235 [MainThread  ] Best validation updated: {'best_iter': 2, 'best_performance': tensor(0.7008), 'current_iter': 2}
2020-05-03 15:37:41,274 [MainThread  ] Save parameters for ./results/debug/finetune_custom_sup_best.ckpt
2020-05-03 15:37:45,049 [MainThread  ] train batch 3 / 1260 (iter 3), current average result {'loss': tensor(0.7140, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7140, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2985, grad_fn=<DivBackward0>)}
2020-05-03 15:38:03,331 [MainThread  ] Experiment debug
2020-05-03 15:38:03,331 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=0, dense_before_fuse=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:38:03,331 [MainThread  ] Start creating tasks
2020-05-03 15:38:03,331 [MainThread  ] Start loading data
2020-05-03 15:38:03,331 [MainThread  ] Loading custom_sup data
2020-05-03 15:38:03,695 [MainThread  ] Start creating models
2020-05-03 15:38:04,921 [MainThread  ] Loaded supervised model
2020-05-03 15:38:04,923 [MainThread  ] Setup trainer for custom_sup
2020-05-03 15:38:04,923 [MainThread  ] Start training custom_sup
2020-05-03 15:38:16,637 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.7540, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7540, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.3192, grad_fn=<DivBackward0>)}
2020-05-03 15:38:26,989 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.7527, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7527, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2982, grad_fn=<DivBackward0>)}
2020-05-03 15:38:26,990 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-03 15:38:29,816 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.6890), 'recon_loss': tensor(0.6890), 'ts_road_map': tensor(0.3692)}
2020-05-03 15:38:31,269 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.6888), 'recon_loss': tensor(0.6888), 'ts_road_map': tensor(0.3702)}
2020-05-03 15:38:32,706 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.6886), 'recon_loss': tensor(0.6886), 'ts_road_map': tensor(0.3710)}
2020-05-03 15:38:34,149 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.6885), 'recon_loss': tensor(0.6885), 'ts_road_map': tensor(0.3716)}
2020-05-03 15:38:35,588 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.6884), 'recon_loss': tensor(0.6884), 'ts_road_map': tensor(0.3720)}
2020-05-03 15:38:38,881 [MainThread  ] Experiment debug
2020-05-03 15:38:38,881 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=1, dense_before_fuse=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='daf_conv_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:38:38,882 [MainThread  ] Start creating tasks
2020-05-03 15:38:38,882 [MainThread  ] Start loading data
2020-05-03 15:38:38,882 [MainThread  ] Loading custom_sup data
2020-05-03 15:38:39,230 [MainThread  ] Start creating models
2020-05-03 15:38:40,455 [MainThread  ] Loaded supervised model
2020-05-03 15:38:40,456 [MainThread  ] Setup trainer for custom_sup
2020-05-03 15:38:40,456 [MainThread  ] Start training custom_sup
2020-05-03 15:38:51,289 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.7236, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7236, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.3106, grad_fn=<DivBackward0>)}
2020-05-03 15:39:02,422 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.7232, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7232, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.3366, grad_fn=<DivBackward0>)}
2020-05-03 15:39:02,425 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-03 15:39:06,257 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.6960), 'recon_loss': tensor(0.6960), 'ts_road_map': tensor(0.3515)}
2020-05-03 15:39:07,893 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.6961), 'recon_loss': tensor(0.6961), 'ts_road_map': tensor(0.3524)}
2020-05-03 15:39:09,548 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.6962), 'recon_loss': tensor(0.6962), 'ts_road_map': tensor(0.3531)}
2020-05-03 15:39:11,042 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.6962), 'recon_loss': tensor(0.6962), 'ts_road_map': tensor(0.3537)}
2020-05-03 15:39:12,513 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.6963), 'recon_loss': tensor(0.6963), 'ts_road_map': tensor(0.3540)}
2020-05-03 15:39:17,891 [MainThread  ] Evalutation complete
Average result {'loss': tensor(0.6963), 'recon_loss': tensor(0.6963), 'ts_road_map': tensor(0.3540)}
2020-05-03 15:39:17,893 [MainThread  ] Best validation updated: {'best_iter': 2, 'best_performance': tensor(0.6963), 'current_iter': 2}
2020-05-03 15:39:18,179 [MainThread  ] Save parameters for ./results/debug/finetune_custom_sup_best.ckpt
2020-05-03 15:39:32,356 [MainThread  ] Experiment debug
2020-05-03 15:39:32,356 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=0, dense_before_fuse=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dense_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:39:32,356 [MainThread  ] Start creating tasks
2020-05-03 15:39:32,357 [MainThread  ] Start loading data
2020-05-03 15:39:32,357 [MainThread  ] Loading custom_sup data
2020-05-03 15:39:32,677 [MainThread  ] Start creating models
2020-05-03 15:39:46,769 [MainThread  ] Experiment debug
2020-05-03 15:39:46,769 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=0, dense_before_fuse=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dense_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:39:46,770 [MainThread  ] Start creating tasks
2020-05-03 15:39:46,770 [MainThread  ] Start loading data
2020-05-03 15:39:46,770 [MainThread  ] Loading custom_sup data
2020-05-03 15:39:47,132 [MainThread  ] Start creating models
2020-05-03 15:39:47,387 [MainThread  ] Loaded supervised model
2020-05-03 15:39:47,389 [MainThread  ] Setup trainer for custom_sup
2020-05-03 15:39:47,389 [MainThread  ] Start training custom_sup
2020-05-03 15:40:13,457 [MainThread  ] Experiment debug
2020-05-03 15:40:13,457 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=0, dense_before_fuse=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dense_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:40:13,457 [MainThread  ] Start creating tasks
2020-05-03 15:40:13,458 [MainThread  ] Start loading data
2020-05-03 15:40:13,458 [MainThread  ] Loading custom_sup data
2020-05-03 15:40:13,802 [MainThread  ] Start creating models
2020-05-03 15:40:14,053 [MainThread  ] Loaded supervised model
2020-05-03 15:40:14,055 [MainThread  ] Setup trainer for custom_sup
2020-05-03 15:40:14,055 [MainThread  ] Start training custom_sup
2020-05-03 15:40:18,762 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.7269, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7269, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.3721, grad_fn=<DivBackward0>)}
2020-05-03 15:40:22,245 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.7272, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7272, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.3350, grad_fn=<DivBackward0>)}
2020-05-03 15:40:22,245 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-03 15:40:24,245 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.6903), 'recon_loss': tensor(0.6903), 'ts_road_map': tensor(0.3647)}
2020-05-03 15:40:25,182 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.6902), 'recon_loss': tensor(0.6902), 'ts_road_map': tensor(0.3657)}
2020-05-03 15:40:26,124 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.6901), 'recon_loss': tensor(0.6901), 'ts_road_map': tensor(0.3665)}
2020-05-03 15:40:27,040 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.6900), 'recon_loss': tensor(0.6900), 'ts_road_map': tensor(0.3671)}
2020-05-03 15:40:27,919 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.6899), 'recon_loss': tensor(0.6899), 'ts_road_map': tensor(0.3675)}
2020-05-03 15:40:33,864 [MainThread  ] Evalutation complete
Average result {'loss': tensor(0.6899), 'recon_loss': tensor(0.6899), 'ts_road_map': tensor(0.3675)}
2020-05-03 15:40:33,865 [MainThread  ] Best validation updated: {'best_iter': 2, 'best_performance': tensor(0.6899), 'current_iter': 2}
2020-05-03 15:40:33,957 [MainThread  ] Save parameters for ./results/debug/finetune_custom_sup_best.ckpt
2020-05-03 15:40:37,555 [MainThread  ] train batch 3 / 1260 (iter 3), current average result {'loss': tensor(0.7367, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7367, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.3347, grad_fn=<DivBackward0>)}
2020-05-03 15:40:41,273 [MainThread  ] train batch 4 / 1260 (iter 4), current average result {'loss': tensor(0.7403, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7403, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.3113, grad_fn=<DivBackward0>)}
2020-05-03 15:40:41,273 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-03 15:40:43,637 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.6897), 'recon_loss': tensor(0.6897), 'ts_road_map': tensor(0.3666)}
2020-05-03 15:40:44,708 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.6895), 'recon_loss': tensor(0.6895), 'ts_road_map': tensor(0.3676)}
2020-05-03 15:40:45,673 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.6894), 'recon_loss': tensor(0.6894), 'ts_road_map': tensor(0.3684)}
2020-05-03 15:40:46,708 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.6893), 'recon_loss': tensor(0.6893), 'ts_road_map': tensor(0.3690)}
2020-05-03 15:40:47,608 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.6892), 'recon_loss': tensor(0.6892), 'ts_road_map': tensor(0.3694)}
2020-05-03 15:43:10,664 [MainThread  ] Experiment debug
2020-05-03 15:43:10,664 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=0, dense_before_fuse=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dense_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:43:10,665 [MainThread  ] Start creating tasks
2020-05-03 15:43:10,665 [MainThread  ] Start loading data
2020-05-03 15:43:10,665 [MainThread  ] Loading custom_sup data
2020-05-03 15:43:11,017 [MainThread  ] Start creating models
2020-05-03 15:43:11,268 [MainThread  ] Loaded supervised model
2020-05-03 15:43:11,271 [MainThread  ] Setup trainer for custom_sup
2020-05-03 15:43:11,271 [MainThread  ] Start training custom_sup
2020-05-03 15:43:16,406 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.7783, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7783, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2965, grad_fn=<DivBackward0>)}
2020-05-03 15:43:20,384 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.7921, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7921, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.3034, grad_fn=<DivBackward0>)}
2020-05-03 15:43:20,384 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-03 15:43:22,466 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.6906), 'recon_loss': tensor(0.6906), 'ts_road_map': tensor(0.3637)}
2020-05-03 15:43:23,410 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.6905), 'recon_loss': tensor(0.6905), 'ts_road_map': tensor(0.3647)}
2020-05-03 15:43:24,304 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.6904), 'recon_loss': tensor(0.6904), 'ts_road_map': tensor(0.3655)}
2020-05-03 15:43:27,581 [MainThread  ] Experiment debug
2020-05-03 15:43:27,581 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=1, dense_before_fuse=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='daf_dense_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:43:27,581 [MainThread  ] Start creating tasks
2020-05-03 15:43:27,582 [MainThread  ] Start loading data
2020-05-03 15:43:27,582 [MainThread  ] Loading custom_sup data
2020-05-03 15:43:27,929 [MainThread  ] Start creating models
2020-05-03 15:43:28,206 [MainThread  ] Loaded supervised model
2020-05-03 15:43:28,208 [MainThread  ] Setup trainer for custom_sup
2020-05-03 15:43:28,208 [MainThread  ] Start training custom_sup
2020-05-03 15:44:49,332 [MainThread  ] Experiment debug
2020-05-03 15:44:49,333 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=1, dense_before_fuse=0, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='daf_dense_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:44:49,333 [MainThread  ] Start creating tasks
2020-05-03 15:44:49,333 [MainThread  ] Start loading data
2020-05-03 15:44:49,333 [MainThread  ] Loading custom_sup data
2020-05-03 15:44:49,681 [MainThread  ] Start creating models
2020-05-03 15:44:49,945 [MainThread  ] Loaded supervised model
2020-05-03 15:44:49,947 [MainThread  ] Setup trainer for custom_sup
2020-05-03 15:44:49,947 [MainThread  ] Start training custom_sup
2020-05-03 15:44:54,660 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.7092, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7092, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2794, grad_fn=<DivBackward0>)}
2020-05-03 15:44:58,178 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.7144, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7144, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2728, grad_fn=<DivBackward0>)}
2020-05-03 15:44:58,178 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-03 15:45:00,102 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.6928), 'recon_loss': tensor(0.6928), 'ts_road_map': tensor(0.3581)}
2020-05-03 15:45:00,979 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.6928), 'recon_loss': tensor(0.6928), 'ts_road_map': tensor(0.3591)}
2020-05-03 15:45:01,866 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.6928), 'recon_loss': tensor(0.6928), 'ts_road_map': tensor(0.3598)}
2020-05-03 15:45:02,743 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.6928), 'recon_loss': tensor(0.6928), 'ts_road_map': tensor(0.3604)}
2020-05-03 15:45:15,240 [MainThread  ] Experiment debug
2020-05-03 15:45:15,241 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=1, dense_before_fuse=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dbf_dense_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:45:15,241 [MainThread  ] Start creating tasks
2020-05-03 15:45:15,241 [MainThread  ] Start loading data
2020-05-03 15:45:15,241 [MainThread  ] Loading custom_sup data
2020-05-03 15:45:15,585 [MainThread  ] Start creating models
2020-05-03 15:45:15,832 [MainThread  ] Loaded supervised model
2020-05-03 15:45:15,834 [MainThread  ] Setup trainer for custom_sup
2020-05-03 15:45:15,834 [MainThread  ] Start training custom_sup
2020-05-03 15:45:20,508 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.7245, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7245, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2738, grad_fn=<DivBackward0>)}
2020-05-03 15:45:24,015 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.7175, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7175, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2915, grad_fn=<DivBackward0>)}
2020-05-03 15:45:24,015 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-03 15:45:25,827 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.7035), 'recon_loss': tensor(0.7035), 'ts_road_map': tensor(0.3392)}
2020-05-03 15:45:26,707 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.7038), 'recon_loss': tensor(0.7038), 'ts_road_map': tensor(0.3401)}
2020-05-03 15:45:27,585 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.7041), 'recon_loss': tensor(0.7041), 'ts_road_map': tensor(0.3407)}
2020-05-03 15:45:28,457 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.7043), 'recon_loss': tensor(0.7043), 'ts_road_map': tensor(0.3412)}
2020-05-03 15:45:29,330 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.7044), 'recon_loss': tensor(0.7044), 'ts_road_map': tensor(0.3416)}
2020-05-03 15:45:34,009 [MainThread  ] Experiment debug
2020-05-03 15:45:34,009 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=0, dense_before_fuse=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dbf_dense_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:45:34,009 [MainThread  ] Start creating tasks
2020-05-03 15:45:34,009 [MainThread  ] Start loading data
2020-05-03 15:45:34,009 [MainThread  ] Loading custom_sup data
2020-05-03 15:45:34,348 [MainThread  ] Start creating models
2020-05-03 15:45:34,600 [MainThread  ] Loaded supervised model
2020-05-03 15:45:34,602 [MainThread  ] Setup trainer for custom_sup
2020-05-03 15:45:34,602 [MainThread  ] Start training custom_sup
2020-05-03 15:45:39,307 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.7553, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7553, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2985, grad_fn=<DivBackward0>)}
2020-05-03 15:45:42,835 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.7500, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7500, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2900, grad_fn=<DivBackward0>)}
2020-05-03 15:45:42,836 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-03 15:45:44,673 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.6987), 'recon_loss': tensor(0.6987), 'ts_road_map': tensor(0.3466)}
2020-05-03 15:45:45,552 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.6989), 'recon_loss': tensor(0.6989), 'ts_road_map': tensor(0.3475)}
2020-05-03 15:45:46,427 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.6990), 'recon_loss': tensor(0.6990), 'ts_road_map': tensor(0.3482)}
2020-05-03 15:45:47,305 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.6991), 'recon_loss': tensor(0.6991), 'ts_road_map': tensor(0.3487)}
2020-05-03 15:45:48,187 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.6992), 'recon_loss': tensor(0.6992), 'ts_road_map': tensor(0.3491)}
2020-05-03 15:45:54,271 [MainThread  ] Evalutation complete
Average result {'loss': tensor(0.6992), 'recon_loss': tensor(0.6992), 'ts_road_map': tensor(0.3491)}
2020-05-03 15:45:54,273 [MainThread  ] Best validation updated: {'best_iter': 2, 'best_performance': tensor(0.6992), 'current_iter': 2}
2020-05-03 15:45:54,321 [MainThread  ] Save parameters for ./results/debug/finetune_custom_sup_best.ckpt
2020-05-03 15:45:58,072 [MainThread  ] train batch 3 / 1260 (iter 3), current average result {'loss': tensor(0.7555, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7555, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.2612, grad_fn=<DivBackward0>)}
2020-05-03 15:46:15,615 [MainThread  ] Experiment debug
2020-05-03 15:46:15,615 [MainThread  ] Receive config Namespace(batch_size=2, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', dense_after_fuse=0, dense_before_fuse=1, detect_objects=False, device='cpu', dup_pos=0, exp_dir='./results/debug', exp_name='debug', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='det_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=10000, finetune_val_interval=2, finetune_weight_decay=1e-05, fuse_type='concat', gen_road_map=True, image_folder='../../../data/data/', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=128, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=1, results_dir='./results/', road_map_loss='bce', sampling_type='image', transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='dbf_dense_concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-05-03 15:46:15,616 [MainThread  ] Start creating tasks
2020-05-03 15:46:15,616 [MainThread  ] Start loading data
2020-05-03 15:46:15,616 [MainThread  ] Loading custom_sup data
2020-05-03 15:46:16,017 [MainThread  ] Start creating models
2020-05-03 15:46:16,288 [MainThread  ] Loaded supervised model
2020-05-03 15:46:16,290 [MainThread  ] Setup trainer for custom_sup
2020-05-03 15:46:16,290 [MainThread  ] Start training custom_sup
2020-05-03 15:46:21,214 [MainThread  ] train batch 1 / 1260 (iter 1), current average result {'loss': tensor(0.7837, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7837, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.3283, grad_fn=<DivBackward0>)}
2020-05-03 15:46:24,651 [MainThread  ] train batch 2 / 1260 (iter 2), current average result {'loss': tensor(0.7789, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7789, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.3267, grad_fn=<DivBackward0>)}
2020-05-03 15:46:24,651 [MainThread  ] Evaluate on  custom_sup:val data
2020-05-03 15:46:26,510 [MainThread  ] eval batch 1 / 252, current average result {'loss': tensor(0.6936), 'recon_loss': tensor(0.6936), 'ts_road_map': tensor(0.3563)}
2020-05-03 15:46:27,363 [MainThread  ] eval batch 2 / 252, current average result {'loss': tensor(0.6936), 'recon_loss': tensor(0.6936), 'ts_road_map': tensor(0.3572)}
2020-05-03 15:46:28,204 [MainThread  ] eval batch 3 / 252, current average result {'loss': tensor(0.6937), 'recon_loss': tensor(0.6937), 'ts_road_map': tensor(0.3580)}
2020-05-03 15:46:29,048 [MainThread  ] eval batch 4 / 252, current average result {'loss': tensor(0.6937), 'recon_loss': tensor(0.6937), 'ts_road_map': tensor(0.3585)}
2020-05-03 15:46:29,906 [MainThread  ] eval batch 5 / 252, current average result {'loss': tensor(0.6937), 'recon_loss': tensor(0.6937), 'ts_road_map': tensor(0.3589)}
2020-05-03 15:46:35,636 [MainThread  ] Evalutation complete
Average result {'loss': tensor(0.6937), 'recon_loss': tensor(0.6937), 'ts_road_map': tensor(0.3589)}
2020-05-03 15:46:35,638 [MainThread  ] Best validation updated: {'best_iter': 2, 'best_performance': tensor(0.6937), 'current_iter': 2}
2020-05-03 15:46:35,685 [MainThread  ] Save parameters for ./results/debug/finetune_custom_sup_best.ckpt
2020-05-03 15:46:39,261 [MainThread  ] train batch 3 / 1260 (iter 3), current average result {'loss': tensor(0.7305, grad_fn=<DivBackward0>), 'recon_loss': tensor(0.7305, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.3539, grad_fn=<DivBackward0>)}
