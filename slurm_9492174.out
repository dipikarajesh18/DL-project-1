2020-04-30 15:35:51,236 [MainThread  ] Experiment road_map_cvar4_bce
2020-04-30 15:35:51,238 [MainThread  ] Receive config Namespace(batch_size=8, beta_ema=0.5, blobs_strategy='encoder_fused', cache_neg=0, clip=0.5, data_dir='./data/', detect_objects=False, device='cuda:0', dup_pos=0, exp_dir='./results/road_map_cvar4_bce', exp_name='road_map_cvar4_bce', finetune_ckpt_interval=0, finetune_learning_rate=0.01, finetune_obj='var_encoder', finetune_tasks=['custom_sup'], finetune_total_iters=200000, finetune_val_interval=2000, finetune_weight_decay=1e-05, gen_road_map=True, image_folder='/scratch/kk4161/DL_project/data', image_pretrain_obj='none', imagessl_load_ckpt='none', lambda_pirl=0.5, latent_dim=4, network_base='resnet18', num_negatives=1000, num_patches=9, num_queries=2, num_queries_percentage=0.25, num_workers=16, obj_det_head='retinanet', pretrain_ckpt_interval=0, pretrain_learning_rate=0.01, pretrain_task=['custom_un_image'], pretrain_total_iters=100000, pretrain_val_interval=2000, pretrain_weight_decay=1e-05, project_dim=128, report_interval=250, results_dir='./results/', road_map_loss='bce', sampling_type='image', synthesizer_nlayers=2, transfer_paradigm='tunable', use_memory_bank=1, view='normal', view_fusion_strategy='concat', view_pretrain_obj='none', viewssl_load_ckpt='none', vocab_size=64, warmup_iters=100)
2020-04-30 15:35:51,239 [MainThread  ] Start creating tasks
2020-04-30 15:35:51,239 [MainThread  ] Start loading data
2020-04-30 15:35:51,239 [MainThread  ] Loading custom_sup data
2020-04-30 15:35:51,608 [MainThread  ] Start creating models
2020-04-30 15:35:51,834 [MainThread  ] Loaded supervised model
2020-04-30 15:35:54,905 [MainThread  ] Setup trainer for custom_sup
2020-04-30 15:35:54,905 [MainThread  ] Start training custom_sup
2020-04-30 15:36:40,330 [MainThread  ] train batch 250 / 315 (iter 250), current average result {'recon_loss': tensor(0.4993, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.4278, grad_fn=<DivBackward0>), 'loss': tensor(124.8273, grad_fn=<DivBackward0>), 'KLD_loss': tensor(124.3280, grad_fn=<DivBackward0>)}
2020-04-30 15:37:24,479 [MainThread  ] train batch 185 / 315 (iter 500), current average result {'recon_loss': tensor(0.4229, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.5087, grad_fn=<DivBackward0>), 'loss': tensor(176.5629, grad_fn=<DivBackward0>), 'KLD_loss': tensor(176.1400, grad_fn=<DivBackward0>)}
2020-04-30 15:38:08,527 [MainThread  ] train batch 120 / 315 (iter 750), current average result {'recon_loss': tensor(0.3792, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.5554, grad_fn=<DivBackward0>), 'loss': tensor(200.6204, grad_fn=<DivBackward0>), 'KLD_loss': tensor(200.2413, grad_fn=<DivBackward0>)}
2020-04-30 15:38:52,659 [MainThread  ] train batch 55 / 315 (iter 1000), current average result {'recon_loss': tensor(0.3478, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.5886, grad_fn=<DivBackward0>), 'loss': tensor(212.9177, grad_fn=<DivBackward0>), 'KLD_loss': tensor(212.5700, grad_fn=<DivBackward0>)}
2020-04-30 15:39:31,968 [MainThread  ] train batch 305 / 315 (iter 1250), current average result {'recon_loss': tensor(0.3237, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.6140, grad_fn=<DivBackward0>), 'loss': tensor(220.9890, grad_fn=<DivBackward0>), 'KLD_loss': tensor(220.6656, grad_fn=<DivBackward0>)}
2020-04-30 15:40:16,472 [MainThread  ] train batch 240 / 315 (iter 1500), current average result {'recon_loss': tensor(0.3029, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.6359, grad_fn=<DivBackward0>), 'loss': tensor(226.0208, grad_fn=<DivBackward0>), 'KLD_loss': tensor(225.7180, grad_fn=<DivBackward0>)}
2020-04-30 15:41:00,943 [MainThread  ] train batch 175 / 315 (iter 1750), current average result {'recon_loss': tensor(0.2856, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.6544, grad_fn=<DivBackward0>), 'loss': tensor(229.9271, grad_fn=<DivBackward0>), 'KLD_loss': tensor(229.6417, grad_fn=<DivBackward0>)}
2020-04-30 15:41:45,073 [MainThread  ] train batch 110 / 315 (iter 2000), current average result {'recon_loss': tensor(0.2709, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.6701, grad_fn=<DivBackward0>), 'loss': tensor(233.2972, grad_fn=<DivBackward0>), 'KLD_loss': tensor(233.0265, grad_fn=<DivBackward0>)}
2020-04-30 15:41:45,073 [MainThread  ] Evaluate on  custom_sup:val data
2020-04-30 15:41:58,328 [MainThread  ] Evalutation complete
Average result {'recon_loss': tensor(0.4682), 'ts_road_map': tensor(0.6691), 'loss': tensor(231.9127), 'KLD_loss': tensor(231.4444)}
2020-04-30 15:41:58,329 [MainThread  ] Best validation updated: {'best_iter': 2000, 'best_performance': tensor(231.9127), 'current_iter': 2000}
2020-04-30 15:41:58,422 [MainThread  ] Save parameters for ./results/road_map_cvar4_bce/finetune_custom_sup_best.ckpt
2020-04-30 15:42:44,618 [MainThread  ] train batch 45 / 315 (iter 2250), current average result {'recon_loss': tensor(0.1569, grad_fn=<DivBackward0>), 'ts_road_map': tensor(0.7926, grad_fn=<DivBackward0>), 'loss': tensor(260.9569, grad_fn=<DivBackward0>), 'KLD_loss': tensor(260.8000, grad_fn=<DivBackward0>)}
slurmstepd: error: *** JOB 9492174 ON gpu-66 CANCELLED AT 2020-04-30T15:43:08 ***
